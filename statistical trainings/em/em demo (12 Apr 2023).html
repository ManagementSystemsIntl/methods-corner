<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.313">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="dcterms.date" content="2023-04-01">

<title>MSI Statistical Training Series</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>


<script src="em demo (12 Apr 2023)_files/libs/clipboard/clipboard.min.js"></script>
<script src="em demo (12 Apr 2023)_files/libs/quarto-html/quarto.js"></script>
<script src="em demo (12 Apr 2023)_files/libs/quarto-html/popper.min.js"></script>
<script src="em demo (12 Apr 2023)_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="em demo (12 Apr 2023)_files/libs/quarto-html/anchor.min.js"></script>
<link href="em demo (12 Apr 2023)_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="em demo (12 Apr 2023)_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="em demo (12 Apr 2023)_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="em demo (12 Apr 2023)_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="em demo (12 Apr 2023)_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-full toc-left">
<div id="quarto-sidebar-toc-left" class="sidebar toc-left">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#background" id="toc-background" class="nav-link active" data-scroll-target="#background">Background</a></li>
  <li><a href="#introduction-to-expectation-maximization" id="toc-introduction-to-expectation-maximization" class="nav-link" data-scroll-target="#introduction-to-expectation-maximization">Introduction to Expectation Maximization</a></li>
  <li><a href="#em-demonstration-using-lca" id="toc-em-demonstration-using-lca" class="nav-link" data-scroll-target="#em-demonstration-using-lca">EM Demonstration Using LCA</a>
  <ul class="collapse">
  <li><a href="#tabulate-the-response-patterns" id="toc-tabulate-the-response-patterns" class="nav-link" data-scroll-target="#tabulate-the-response-patterns">1. Tabulate the response patterns</a></li>
  <li><a href="#set-initial-values-of-model-parameters" id="toc-set-initial-values-of-model-parameters" class="nav-link" data-scroll-target="#set-initial-values-of-model-parameters">2. Set initial values of model parameters</a></li>
  <li><a href="#estimate-probabilities-of-response-patterns" id="toc-estimate-probabilities-of-response-patterns" class="nav-link" data-scroll-target="#estimate-probabilities-of-response-patterns">3. Estimate probabilities of response patterns</a></li>
  <li><a href="#estimate-the-component-probabilities-within-each-component" id="toc-estimate-the-component-probabilities-within-each-component" class="nav-link" data-scroll-target="#estimate-the-component-probabilities-within-each-component">4. Estimate the component probabilities within each component</a></li>
  <li><a href="#estimate-frequency-counts-of-estimated-components" id="toc-estimate-frequency-counts-of-estimated-components" class="nav-link" data-scroll-target="#estimate-frequency-counts-of-estimated-components">5. Estimate frequency counts of estimated components</a></li>
  <li><a href="#estimate-new-model-parameters" id="toc-estimate-new-model-parameters" class="nav-link" data-scroll-target="#estimate-new-model-parameters">6. Estimate new model parameters</a></li>
  </ul></li>
  <li><a href="#iterate-the-model" id="toc-iterate-the-model" class="nav-link" data-scroll-target="#iterate-the-model">Iterate the model</a></li>
  </ul>
</nav>
</div>
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
</div>
<main class="content page-columns page-full column-body" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">MSI Statistical Training Series</h1>
<p class="subtitle lead">Expectation Maximization (EM)</p>
</div>



<div class="quarto-title-meta">

    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">April 1, 2023</p>
    </div>
  </div>
  
    
  </div>
  

</header>

<section id="background" class="level2">
<h2 class="anchored" data-anchor-id="background">Background</h2>
<p>The MSI Statistical Training Series offers tutorials on a range of topics that are commonly applied in data analysis. The objective is to i) refresh readers on the derivation and application of methods from a first statistics course, ii) provide the underlying theory that goes beyond an introductory statistics course, iii) introduce readers to new methods that would not be covered in an introductory statistics course, and iv) provide practical, hands-on coding examples to enable users of statistical analysis software to gain proficiency in coding skills not just to run statistical procedures, but also to derive statistical procedures through the underlying theory.</p>
<p>Exploration of each topic should include the underlying theory, a demonstration using toy or fake data, and a real-world application in data that MSI has generated for a client deliverable.</p>
</section>
<section id="introduction-to-expectation-maximization" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="introduction-to-expectation-maximization">Introduction to Expectation Maximization</h2>
<p>The Expectation Maximization (EM) algorithm is a popular approach to maximum likelihood estimation with missing data. The seminal reference is <span class="citation" data-cites="dempster1977">(<a href="#ref-dempster1977" role="doc-biblioref">Dempster, Laird, and Rubin 1977</a>)</span>, which is among the most often cited article in the field of statistics.</p>
<div class="no-row-height column-margin column-container"><div id="ref-dempster1977" class="csl-entry" role="doc-biblioentry">
Dempster, A. P., N. M. Laird, and D. B. Rubin. 1977. <span>“Maximum Likelihood from Incomplete Data Via the EM Algorithm.”</span> <em>Journal of the Royal Statistical Society: Series B (Methodological)</em> 39 (1): 1–22. <a href="https://doi.org/10.1111/j.2517-6161.1977.tb01600.x">https://doi.org/10.1111/j.2517-6161.1977.tb01600.x</a>.
</div></div><p>The EM algorithm applies to problems of missing data, which has applications beyond the most direct use case of missing data imputation. For example, one may suspect that there is hidden structure in the data, and the missing data are labels identifying this structure (sex in a data set of heights; seasons in a data set of temperatures).</p>
<p>We may have data on an outcome Y which shows a bimodal distribution. We may suspect that this bimodal shape represents the missing data of sex - or in this case a missing variable, or label, that designates which sex the outcome observation belongs to. Or, we may have a set of covariate values for an outcome, and there are particular patterns in the values of these covariates that suggests the presence of a hidden, or latent, variable. This leads to the use of EM for the purposes of identifiying these missing or latent variables, with one approach being that of Latent Class Analysis (LCA).</p>
<div class="page-columns page-full"><p>The EM algorithm comprises two steps. First, we compute the expected value of the missing data, given the values of the observed data and ‘current’ parameter values.<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a> For a latent class model, we compute <span class="math inline">\(P(X=c|y_1, …, y_j)\)</span> using the current parameter estimates. We then re-estimate the model probabilities <span class="math inline">\(P(X=c)\)</span> and <span class="math inline">\(P(y_j|X=c)\)</span> treating class membership as if it were observed and using the <span class="math inline">\(P(X=c|y_1, ..., y_j)\)</span> as weights. Somehow, each iteration of this process will improve the estimates until the algorithm converges to a solution.<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a></p><div class="no-row-height column-margin column-container"><li id="fn1"><p><sup>1</sup>&nbsp;‘Current’ only denoting that we first start off with a guess of parameter values, then subsequently use the updated parameter values generated from the previous iteration of the EM algorithm.</p></li><li id="fn2"><p><sup>2</sup>&nbsp;A proof exists, but I don’t yet understand intuitively how this is possible.</p></li></div></div>
</section>
<section id="em-demonstration-using-lca" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="em-demonstration-using-lca">EM Demonstration Using LCA</h2>
<p>We will demonstrate an application of the EM algorithm using Latent Class Analysis.</p>
<div class="page-columns page-full"><p>Consider a survey asking respondents about their attitude towards the limits of tolerance of anti-religious sentiment.<a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a> The questions ask whether anti-religionists should be allowed to speak (y1), whether anti-religionists should be allowed to teach (y2), and whether anti-religious books ought to be allowed in public libraries (y3). For each item, 1 indicates agreement (allowed to speak, allowed to teach, allowed to keep books in library) and interpreted as high tolerance for anti-religious sentiment, and 2 indicates disagreement and interpreted as low tolerance for anti-religious sentiment.</p><div class="no-row-height column-margin column-container"><li id="fn3"><p><sup>3</sup>&nbsp;This data comes from the 1987 General Social Science (GSS) survey. See the <a href="https://kjhealy.github.io/gssr/index.html" title="gssr package for all GSS years">gssr</a> package for data on all years.</p></li></div></div>
<div class="cell" data-hash="em-demo--12-Apr-2023-_cache/html/unnamed-chunk-1_8d9cbdcde9cf00304898195ad6caaa91">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"gss87 antirel.csv"</span>)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">flextable</span>(d[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>,])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div class="tabwid"><style>.cl-631d046a{}.cl-63158140{font-family:'Arial';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-631851f4{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-631851fe{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-6318652c{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6318652d{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-63186536{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-63186537{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-63186540{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-63186541{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing="true" class="cl-631d046a"><thead><tr style="overflow-wrap:break-word;"><th class="cl-6318652c"><p class="cl-631851f4"><span class="cl-63158140">y1</span></p></th><th class="cl-6318652c"><p class="cl-631851f4"><span class="cl-63158140">y2</span></p></th><th class="cl-6318652c"><p class="cl-631851f4"><span class="cl-63158140">y3</span></p></th><th class="cl-6318652d"><p class="cl-631851fe"><span class="cl-63158140">cum</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-63186536"><p class="cl-631851f4"><span class="cl-63158140">1</span></p></td><td class="cl-63186536"><p class="cl-631851f4"><span class="cl-63158140">1</span></p></td><td class="cl-63186536"><p class="cl-631851f4"><span class="cl-63158140">1</span></p></td><td class="cl-63186537"><p class="cl-631851fe"><span class="cl-63158140">1-1-1</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-63186536"><p class="cl-631851f4"><span class="cl-63158140">1</span></p></td><td class="cl-63186536"><p class="cl-631851f4"><span class="cl-63158140">1</span></p></td><td class="cl-63186536"><p class="cl-631851f4"><span class="cl-63158140">1</span></p></td><td class="cl-63186537"><p class="cl-631851fe"><span class="cl-63158140">1-1-1</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-63186536"><p class="cl-631851f4"><span class="cl-63158140">1</span></p></td><td class="cl-63186536"><p class="cl-631851f4"><span class="cl-63158140">2</span></p></td><td class="cl-63186536"><p class="cl-631851f4"><span class="cl-63158140">2</span></p></td><td class="cl-63186537"><p class="cl-631851fe"><span class="cl-63158140">1-2-2</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-63186536"><p class="cl-631851f4"><span class="cl-63158140">1</span></p></td><td class="cl-63186536"><p class="cl-631851f4"><span class="cl-63158140">1</span></p></td><td class="cl-63186536"><p class="cl-631851f4"><span class="cl-63158140">1</span></p></td><td class="cl-63186537"><p class="cl-631851fe"><span class="cl-63158140">1-1-1</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-63186540"><p class="cl-631851f4"><span class="cl-63158140">1</span></p></td><td class="cl-63186540"><p class="cl-631851f4"><span class="cl-63158140">1</span></p></td><td class="cl-63186540"><p class="cl-631851f4"><span class="cl-63158140">1</span></p></td><td class="cl-63186541"><p class="cl-631851fe"><span class="cl-63158140">1-1-1</span></p></td></tr></tbody></table></div>
</div>
</div>
<div class="cell" data-hash="em-demo--12-Apr-2023-_cache/html/unnamed-chunk-2_a5bfcf9e980322de8c84f3db67fed71d">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co">#| output: asis</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="fu">tab_stackfrq</span>(d[,<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>],</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>             <span class="at">digits=</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<table style="border-collapse:collapse; border:none; border-bottom:double black;">
<tbody><tr>
<th style="border-top:double black; border-bottom:1px solid black; padding:0.2cm;">&nbsp;</th>
<th style="border-top:double black; border-bottom:1px solid black; padding:0.2cm;">1</th>
<th style="border-top:double black; border-bottom:1px solid black; padding:0.2cm;">2</th>
</tr>
<tr>
<td style="font-style:italic;">y1</td>
<td style="padding:0.2cm; text-align:center;">68.2&nbsp;%</td>
<td style="padding:0.2cm; text-align:center;">31.8&nbsp;%</td>
</tr>
<tr>
<td style="font-style:italic;">y2</td>
<td style="padding:0.2cm; text-align:center;">47.7&nbsp;%</td>
<td style="padding:0.2cm; text-align:center;">52.3&nbsp;%</td>
</tr>
<tr>
<td style="font-style:italic;">y3</td>
<td style="padding:0.2cm; text-align:center;">66.0&nbsp;%</td>
<td style="padding:0.2cm; text-align:center;">34.0&nbsp;%</td>
</tr>
 
</tbody></table>
</div>
</div>
<p>A slight majority of respondents agreed with items one and three, while item two was about evenly split. Perhaps there are two broad groups of respondents, those who are typically tolerant of anti-religious sentiment, and those who are not. We will now go through a series of steps in implementing the EM algorithm to identify these latent variables.</p>
<section id="tabulate-the-response-patterns" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="tabulate-the-response-patterns">1. Tabulate the response patterns</h3>
<p>We are interested in using the patterns of responses on the y1, y2, y3 variables to identify these two broad classes of respondents, so we created a new variable that captures their pattern across each respondent. We can then tabulate the frequencies of these patterns.</p>
<div class="cell" data-hash="em-demo--12-Apr-2023-_cache/html/unnamed-chunk-3_5e36508317c2e7521857c112e06fb156">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>freqs <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">frq</span>(d<span class="sc">$</span>cum)) <span class="sc">%&gt;%</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>  .[<span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>, <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">5</span>)] <span class="sc">%&gt;%</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">perc=</span><span class="fu">round</span>(raw.prc<span class="sc">/</span><span class="dv">100</span>,<span class="dv">3</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>raw.prc)</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="fu">flextable</span>(freqs)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div class="tabwid"><style>.cl-63f526ec{}.cl-63ee24be{font-family:'Arial';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-63f0c778{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-63f0c782{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-63f0d81c{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-63f0d826{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-63f0d827{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-63f0d830{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-63f0d83a{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-63f0d83b{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing="true" class="cl-63f526ec"><thead><tr style="overflow-wrap:break-word;"><th class="cl-63f0d81c"><p class="cl-63f0c778"><span class="cl-63ee24be">val</span></p></th><th class="cl-63f0d826"><p class="cl-63f0c782"><span class="cl-63ee24be">frq</span></p></th><th class="cl-63f0d826"><p class="cl-63f0c782"><span class="cl-63ee24be">perc</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-63f0d827"><p class="cl-63f0c778"><span class="cl-63ee24be">1-1-1</span></p></td><td class="cl-63f0d830"><p class="cl-63f0c782"><span class="cl-63ee24be">696</span></p></td><td class="cl-63f0d830"><p class="cl-63f0c782"><span class="cl-63ee24be">0.406</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-63f0d827"><p class="cl-63f0c778"><span class="cl-63ee24be">1-1-2</span></p></td><td class="cl-63f0d830"><p class="cl-63f0c782"><span class="cl-63ee24be">68</span></p></td><td class="cl-63f0d830"><p class="cl-63f0c782"><span class="cl-63ee24be">0.040</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-63f0d827"><p class="cl-63f0c778"><span class="cl-63ee24be">1-2-1</span></p></td><td class="cl-63f0d830"><p class="cl-63f0c782"><span class="cl-63ee24be">275</span></p></td><td class="cl-63f0d830"><p class="cl-63f0c782"><span class="cl-63ee24be">0.160</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-63f0d827"><p class="cl-63f0c778"><span class="cl-63ee24be">1-2-2</span></p></td><td class="cl-63f0d830"><p class="cl-63f0c782"><span class="cl-63ee24be">130</span></p></td><td class="cl-63f0d830"><p class="cl-63f0c782"><span class="cl-63ee24be">0.076</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-63f0d827"><p class="cl-63f0c778"><span class="cl-63ee24be">2-1-1</span></p></td><td class="cl-63f0d830"><p class="cl-63f0c782"><span class="cl-63ee24be">34</span></p></td><td class="cl-63f0d830"><p class="cl-63f0c782"><span class="cl-63ee24be">0.020</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-63f0d827"><p class="cl-63f0c778"><span class="cl-63ee24be">2-1-2</span></p></td><td class="cl-63f0d830"><p class="cl-63f0c782"><span class="cl-63ee24be">19</span></p></td><td class="cl-63f0d830"><p class="cl-63f0c782"><span class="cl-63ee24be">0.011</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-63f0d827"><p class="cl-63f0c778"><span class="cl-63ee24be">2-2-1</span></p></td><td class="cl-63f0d830"><p class="cl-63f0c782"><span class="cl-63ee24be">125</span></p></td><td class="cl-63f0d830"><p class="cl-63f0c782"><span class="cl-63ee24be">0.073</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-63f0d83a"><p class="cl-63f0c778"><span class="cl-63ee24be">2-2-2</span></p></td><td class="cl-63f0d83b"><p class="cl-63f0c782"><span class="cl-63ee24be">366</span></p></td><td class="cl-63f0d83b"><p class="cl-63f0c782"><span class="cl-63ee24be">0.214</span></p></td></tr></tbody></table></div>
</div>
</div>
<p>We suspect the pattern of responses of each of the three indicator variables arise due to the existence of two components, or latent variables, in the data. We will call this latent variable X, which can take on values of component 1 (X=1) or component 2 (X=2). We will refer to the observed indicator variables as <span class="math inline">\(y_1, y_2, .., y_n\)</span>.</p>
<p>We want to use the observed frequencies of the response patterns to infer the existence of the components X. To do that, we posit a data-generating process, a model of <span class="math inline">\(P(y_1, y_2, y_3)\)</span> described in the table above. There are two key assumptions of this model:</p>
<ol type="1">
<li><p>The observed frequencies of the pattern of responses <span class="math inline">\(y_1, y_2, y_3\)</span> is the result of a mixture of two separate components, each with their own distribution. If this were true, then the observed frequency could be expressed as</p>
<p><span id="eq-ass1"><span class="math display">\[
P(y_1, y_2, y_3)=P(X=1)P(y_1, y_2, y_3|X=1) + P(X=2)P(y_1, y_2, y_3|X=2)
\tag{1}\]</span></span></p>
<p>Note that the probabilities of the indicator variables for each component<a href="#fn4" class="footnote-ref" id="fnref4" role="doc-noteref"><sup>4</sup></a>, as well as the share of each component in the sample<a href="#fn5" class="footnote-ref" id="fnref5" role="doc-noteref"><sup>5</sup></a> , are not observed - they are the parameters of the model.</p></li>
<li><p>Within each component, responses are independent (<em>local independence</em>). Within each component, knowing <span class="math inline">\(y_1\)</span> offers no information about <span class="math inline">\(y_2\)</span>. If this is true, then the probability of observing a given pattern of responses is simply the product of their probabilities.</p>
<p><span id="eq-ass2"><span class="math display">\[
P(y_1,y_2,y_3|X=1)=P(y_1|X=1)P(y_2|X=1)P(y_3|X=1)
\tag{2}\]</span></span></p>
<p>Again note that the notation above refers not to observed probabilities, but the parameter probabilities of the model.</p></li>
</ol>
<div class="no-row-height column-margin column-container"><li id="fn4"><p><sup>4</sup>&nbsp;<span class="math inline">\(P(y_i|X=c)\)</span></p></li><li id="fn5"><p><sup>5</sup>&nbsp;<span class="math inline">\(P(X=c)\)</span></p></li></div><p>The above model assumptions identify two sets of parameters that will generate our observed information. The first set of parameters is the proportion of the sample belonging to each component. This is <span class="math inline">\(P(X=1,2)\)</span> from model assumption (1) above. Second, we need the proportion of each indicator variable (the y1, y2, y3) within each assigned component. This is <span class="math inline">\(P(Y1=1|X=1,2), P(Y2=1|X=1,2), P(Y3=1|X=1,2)\)</span>. Knowing these parameter values allows us to generate the joint probability of the pattern of responses in the indicator variables described in model assumption (2).</p>
</section>
<section id="set-initial-values-of-model-parameters" class="level3">
<h3 class="anchored" data-anchor-id="set-initial-values-of-model-parameters">2. Set initial values of model parameters</h3>
<p>We will start by arbitrarily setting initial values for these parameters, and then use these values to estimate the probabilities that each observation belongs to each component. Let’s start off by saying that components 1 and 2 are evenly apportioned in the sample, and that the probabilities of an observation being 1 for each of the indicator variables is 60 percent.</p>
<div class="cell" data-hash="em-demo--12-Apr-2023-_cache/html/unnamed-chunk-4_bcd097e49ae142676ecbb861a96ef3e7">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>p_x1 <span class="ot">&lt;-</span> .<span class="dv">5</span> <span class="co"># share of component 1, iteration 1</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>p_x2 <span class="ot">&lt;-</span> .<span class="dv">5</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>y1_x1 <span class="ot">&lt;-</span> .<span class="dv">6</span> <span class="co"># probability of y1 for component 1, iteration 1</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>y2_x1 <span class="ot">&lt;-</span> .<span class="dv">6</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>y3_x1 <span class="ot">&lt;-</span> .<span class="dv">6</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>y1_x2 <span class="ot">&lt;-</span> .<span class="dv">4</span> <span class="co"># probability of y1 for component 2, iteration 1</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>y2_x2 <span class="ot">&lt;-</span> .<span class="dv">4</span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>y3_x2 <span class="ot">&lt;-</span> .<span class="dv">4</span></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>params1 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">estimate=</span><span class="st">"current"</span>,</span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>                      <span class="at">probs=</span><span class="fu">c</span>(<span class="st">"P(X)"</span>,<span class="st">"P(y1=1|X)"</span>,<span class="st">"P(y2=1|X)"</span>, <span class="st">"P(y3=1|X)"</span>),</span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>                      <span class="at">iteration=</span><span class="dv">1</span>,</span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>                      <span class="at">X1=</span><span class="fu">c</span>(.<span class="dv">5</span>,.<span class="dv">6</span>,.<span class="dv">6</span>,.<span class="dv">6</span>),</span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>                      <span class="at">X2=</span><span class="fu">c</span>(.<span class="dv">5</span>,.<span class="dv">4</span>,.<span class="dv">4</span>,.<span class="dv">4</span>))</span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a><span class="fu">flextable</span>(params1) <span class="sc">%&gt;%</span></span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_header_labels</span>(<span class="at">X1=</span><span class="st">"X=1"</span>,</span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a>                    <span class="at">X2=</span><span class="st">"X=2"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div class="tabwid"><style>.cl-641122ac{}.cl-640995f0{font-family:'Arial';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-640c6848{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-640c6852{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-640c79b4{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-640c79be{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-640c79c8{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-640c79c9{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-640c79d2{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-640c79d3{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing="true" class="cl-641122ac"><thead><tr style="overflow-wrap:break-word;"><th class="cl-640c79b4"><p class="cl-640c6848"><span class="cl-640995f0">estimate</span></p></th><th class="cl-640c79b4"><p class="cl-640c6848"><span class="cl-640995f0">probs</span></p></th><th class="cl-640c79be"><p class="cl-640c6852"><span class="cl-640995f0">iteration</span></p></th><th class="cl-640c79be"><p class="cl-640c6852"><span class="cl-640995f0">X=1</span></p></th><th class="cl-640c79be"><p class="cl-640c6852"><span class="cl-640995f0">X=2</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-640c79c8"><p class="cl-640c6848"><span class="cl-640995f0">current</span></p></td><td class="cl-640c79c8"><p class="cl-640c6848"><span class="cl-640995f0">P(X)</span></p></td><td class="cl-640c79c9"><p class="cl-640c6852"><span class="cl-640995f0">1</span></p></td><td class="cl-640c79c9"><p class="cl-640c6852"><span class="cl-640995f0">0.5</span></p></td><td class="cl-640c79c9"><p class="cl-640c6852"><span class="cl-640995f0">0.5</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-640c79c8"><p class="cl-640c6848"><span class="cl-640995f0">current</span></p></td><td class="cl-640c79c8"><p class="cl-640c6848"><span class="cl-640995f0">P(y1=1|X)</span></p></td><td class="cl-640c79c9"><p class="cl-640c6852"><span class="cl-640995f0">1</span></p></td><td class="cl-640c79c9"><p class="cl-640c6852"><span class="cl-640995f0">0.6</span></p></td><td class="cl-640c79c9"><p class="cl-640c6852"><span class="cl-640995f0">0.4</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-640c79c8"><p class="cl-640c6848"><span class="cl-640995f0">current</span></p></td><td class="cl-640c79c8"><p class="cl-640c6848"><span class="cl-640995f0">P(y2=1|X)</span></p></td><td class="cl-640c79c9"><p class="cl-640c6852"><span class="cl-640995f0">1</span></p></td><td class="cl-640c79c9"><p class="cl-640c6852"><span class="cl-640995f0">0.6</span></p></td><td class="cl-640c79c9"><p class="cl-640c6852"><span class="cl-640995f0">0.4</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-640c79d2"><p class="cl-640c6848"><span class="cl-640995f0">current</span></p></td><td class="cl-640c79d2"><p class="cl-640c6848"><span class="cl-640995f0">P(y3=1|X)</span></p></td><td class="cl-640c79d3"><p class="cl-640c6852"><span class="cl-640995f0">1</span></p></td><td class="cl-640c79d3"><p class="cl-640c6852"><span class="cl-640995f0">0.6</span></p></td><td class="cl-640c79d3"><p class="cl-640c6852"><span class="cl-640995f0">0.4</span></p></td></tr></tbody></table></div>
</div>
</div>
</section>
<section id="estimate-probabilities-of-response-patterns" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="estimate-probabilities-of-response-patterns">3. Estimate probabilities of response patterns</h3>
<p>We now use the initial indicator parameters to estimate a probability of observing a given response pattern <span class="math inline">\(P(y_1, y_2, y_3|X=x)\)</span>, where the <span class="math inline">\(y_1, y_2, y_3\)</span> are the observed patterns of responses in the sample, and the Xs are the current parameter estimates of the probability of each indicator variable for each component. If you’re trying to follow along, here are the observed indicator response pattern frequencies and initial parameter estimates.</p>
<div class="cell" data-hash="em-demo--12-Apr-2023-_cache/html/unnamed-chunk-5_0ff99070195ac8ef57fb268dc53d4f5e">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>freqs <span class="sc">%&gt;%</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="st">"html"</span>, <span class="at">align =</span> <span class="st">'clc'</span>, <span class="at">caption =</span> <span class="st">'Observed pattern of responses'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">kable_styling</span>(<span class="at">full_width =</span> F, <span class="at">position =</span> <span class="st">"float_left"</span>)</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>params1 <span class="sc">%&gt;%</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="st">"html"</span>, <span class="at">align =</span> <span class="st">'clc'</span>, <span class="at">caption =</span> <span class="st">'Initial parameter values'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">kable_styling</span>(<span class="at">full_width =</span> F, <span class="at">position =</span> <span class="st">"float_right"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<table class="table" style="width: auto !important; float: left; margin-right: 10px;">
<caption>Observed pattern of responses</caption>
 <thead>
  <tr>
   <th style="text-align:center;"> val </th>
   <th style="text-align:left;"> frq </th>
   <th style="text-align:center;"> perc </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:center;"> 1-1-1 </td>
   <td style="text-align:left;"> 696 </td>
   <td style="text-align:center;"> 0.406 </td>
  </tr>
  <tr>
   <td style="text-align:center;"> 1-1-2 </td>
   <td style="text-align:left;"> 68 </td>
   <td style="text-align:center;"> 0.040 </td>
  </tr>
  <tr>
   <td style="text-align:center;"> 1-2-1 </td>
   <td style="text-align:left;"> 275 </td>
   <td style="text-align:center;"> 0.160 </td>
  </tr>
  <tr>
   <td style="text-align:center;"> 1-2-2 </td>
   <td style="text-align:left;"> 130 </td>
   <td style="text-align:center;"> 0.076 </td>
  </tr>
  <tr>
   <td style="text-align:center;"> 2-1-1 </td>
   <td style="text-align:left;"> 34 </td>
   <td style="text-align:center;"> 0.020 </td>
  </tr>
  <tr>
   <td style="text-align:center;"> 2-1-2 </td>
   <td style="text-align:left;"> 19 </td>
   <td style="text-align:center;"> 0.011 </td>
  </tr>
  <tr>
   <td style="text-align:center;"> 2-2-1 </td>
   <td style="text-align:left;"> 125 </td>
   <td style="text-align:center;"> 0.073 </td>
  </tr>
  <tr>
   <td style="text-align:center;"> 2-2-2 </td>
   <td style="text-align:left;"> 366 </td>
   <td style="text-align:center;"> 0.214 </td>
  </tr>
</tbody>
</table>

<table class="table" style="width: auto !important; float: right; margin-left: 10px;">
<caption>Initial parameter values</caption>
 <thead>
  <tr>
   <th style="text-align:center;"> estimate </th>
   <th style="text-align:left;"> probs </th>
   <th style="text-align:center;"> iteration </th>
   <th style="text-align:center;"> X1 </th>
   <th style="text-align:left;"> X2 </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:center;"> current </td>
   <td style="text-align:left;"> P(X) </td>
   <td style="text-align:center;"> 1 </td>
   <td style="text-align:center;"> 0.5 </td>
   <td style="text-align:left;"> 0.5 </td>
  </tr>
  <tr>
   <td style="text-align:center;"> current </td>
   <td style="text-align:left;"> P(y1=1|X) </td>
   <td style="text-align:center;"> 1 </td>
   <td style="text-align:center;"> 0.6 </td>
   <td style="text-align:left;"> 0.4 </td>
  </tr>
  <tr>
   <td style="text-align:center;"> current </td>
   <td style="text-align:left;"> P(y2=1|X) </td>
   <td style="text-align:center;"> 1 </td>
   <td style="text-align:center;"> 0.6 </td>
   <td style="text-align:left;"> 0.4 </td>
  </tr>
  <tr>
   <td style="text-align:center;"> current </td>
   <td style="text-align:left;"> P(y3=1|X) </td>
   <td style="text-align:center;"> 1 </td>
   <td style="text-align:center;"> 0.6 </td>
   <td style="text-align:left;"> 0.4 </td>
  </tr>
</tbody>
</table>

</div>
</div>
<p>The most common response pattern is 1-1-1, which occurred in 41 percent of respondents.</p>
<p>Given our initial model parameters that each indicator value has a 60 percent probability of belonging to component 1 and a 40 percent probability of belonging to component 2, then we would expect to see the pattern (1-1-1) to be <span class="math inline">\(.6*.6*.6\)</span> = 21.6% of the time in component 1, and <span class="math inline">\(.4*.4*.4\)</span> = 6.4% of the time in component 2. These estimates represent <span class="math inline">\(P(y_1, y_2, y_3|X=c)\)</span>.</p>
<p>Probability of response patterns, if they belonged to component 1.</p>
<div class="cell" data-hash="em-demo--12-Apr-2023-_cache/html/unnamed-chunk-6_83eab265e2fb52387dbabce1b71a0efc">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>x1_111 <span class="ot">&lt;-</span> y1_x1<span class="sc">*</span>y2_x1<span class="sc">*</span>y3_x1 </span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="co"># probability of 1-1-1 belonging to component 1</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>x1_112 <span class="ot">&lt;-</span> y1_x1<span class="sc">*</span>y1_x1<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>y3_x1)</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="co"># probability of 1-1-2 belonging to component 1</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>x1_121 <span class="ot">&lt;-</span> y1_x1<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>y2_x1)<span class="sc">*</span>y3_x1</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a><span class="co"># probability of 1-2-1 belonging to component 1</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>x1_122 <span class="ot">&lt;-</span> y1_x1<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>y2_x1)<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>y3_x1)</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>x1_211 <span class="ot">&lt;-</span> (<span class="dv">1</span><span class="sc">-</span>y1_x1)<span class="sc">*</span>y2_x1<span class="sc">*</span>y3_x1</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>x1_212 <span class="ot">&lt;-</span> (<span class="dv">1</span><span class="sc">-</span>y1_x1)<span class="sc">*</span>y2_x1<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>y3_x1)</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>x1_221 <span class="ot">&lt;-</span> (<span class="dv">1</span><span class="sc">-</span>y1_x1)<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>y2_x1)<span class="sc">*</span>(y3_x1)</span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>x1_222 <span class="ot">&lt;-</span> (<span class="dv">1</span><span class="sc">-</span>y1_x1)<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>y2_x1)<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>y3_x1)</span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>jointy_x1 <span class="ot">&lt;-</span> <span class="fu">c</span>(x1_111, x1_112, x1_121, x1_122, x1_211, x1_212, x1_221, x1_222)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Probability of response patterns, if they belonged to component 2.</p>
<div class="cell" data-hash="em-demo--12-Apr-2023-_cache/html/unnamed-chunk-7_022f36578f6e12fbfdc8bd39c381f002">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>x2_111 <span class="ot">&lt;-</span> y1_x2<span class="sc">*</span>y2_x2<span class="sc">*</span>y3_x2 </span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="co"># probability of 1-1-1 belonging to component 1</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>x2_112 <span class="ot">&lt;-</span> y1_x2<span class="sc">*</span>y1_x2<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>y3_x2)</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="co"># probability of 1-1-2 belonging to component 1</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>x2_121 <span class="ot">&lt;-</span> y1_x2<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>y2_x2)<span class="sc">*</span>y3_x2</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a><span class="co"># probability of 1-2-1 belonging to component 1</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>x2_122 <span class="ot">&lt;-</span> y1_x2<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>y2_x2)<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>y3_x2)</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>x2_211 <span class="ot">&lt;-</span> (<span class="dv">1</span><span class="sc">-</span>y1_x2)<span class="sc">*</span>y2_x2<span class="sc">*</span>y3_x2</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>x2_212 <span class="ot">&lt;-</span> (<span class="dv">1</span><span class="sc">-</span>y1_x2)<span class="sc">*</span>y2_x2<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>y3_x2)</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>x2_221 <span class="ot">&lt;-</span> (<span class="dv">1</span><span class="sc">-</span>y1_x2)<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>y2_x2)<span class="sc">*</span>(y3_x2)</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>x2_222 <span class="ot">&lt;-</span> (<span class="dv">1</span><span class="sc">-</span>y1_x2)<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>y2_x2)<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>y3_x2)</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>jointy_x2 <span class="ot">&lt;-</span> <span class="fu">c</span>(x2_111, x2_112, x2_121, x2_122, x2_211, x2_212, x2_221, x2_222)</span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>freqs1 <span class="ot">&lt;-</span> freqs <span class="sc">%&gt;%</span></span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">iteration=</span><span class="dv">1</span>,</span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>         <span class="at">joint_x1=</span>jointy_x1,</span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a>         <span class="at">joint_x2=</span>jointy_x2)</span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a><span class="fu">flextable</span>(freqs1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div class="tabwid"><style>.cl-70210518{}.cl-7019af66{font-family:'Arial';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-701c856a{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-701c8574{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-701c9938{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-701c9939{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-701c9942{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-701c9943{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-701c9944{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-701c9945{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing="true" class="cl-70210518"><thead><tr style="overflow-wrap:break-word;"><th class="cl-701c9938"><p class="cl-701c856a"><span class="cl-7019af66">val</span></p></th><th class="cl-701c9939"><p class="cl-701c8574"><span class="cl-7019af66">frq</span></p></th><th class="cl-701c9939"><p class="cl-701c8574"><span class="cl-7019af66">perc</span></p></th><th class="cl-701c9939"><p class="cl-701c8574"><span class="cl-7019af66">iteration</span></p></th><th class="cl-701c9939"><p class="cl-701c8574"><span class="cl-7019af66">joint_x1</span></p></th><th class="cl-701c9939"><p class="cl-701c8574"><span class="cl-7019af66">joint_x2</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-701c9942"><p class="cl-701c856a"><span class="cl-7019af66">1-1-1</span></p></td><td class="cl-701c9943"><p class="cl-701c8574"><span class="cl-7019af66">696</span></p></td><td class="cl-701c9943"><p class="cl-701c8574"><span class="cl-7019af66">0.406</span></p></td><td class="cl-701c9943"><p class="cl-701c8574"><span class="cl-7019af66">1</span></p></td><td class="cl-701c9943"><p class="cl-701c8574"><span class="cl-7019af66">0.216</span></p></td><td class="cl-701c9943"><p class="cl-701c8574"><span class="cl-7019af66">0.064</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-701c9942"><p class="cl-701c856a"><span class="cl-7019af66">1-1-2</span></p></td><td class="cl-701c9943"><p class="cl-701c8574"><span class="cl-7019af66">68</span></p></td><td class="cl-701c9943"><p class="cl-701c8574"><span class="cl-7019af66">0.040</span></p></td><td class="cl-701c9943"><p class="cl-701c8574"><span class="cl-7019af66">1</span></p></td><td class="cl-701c9943"><p class="cl-701c8574"><span class="cl-7019af66">0.144</span></p></td><td class="cl-701c9943"><p class="cl-701c8574"><span class="cl-7019af66">0.096</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-701c9942"><p class="cl-701c856a"><span class="cl-7019af66">1-2-1</span></p></td><td class="cl-701c9943"><p class="cl-701c8574"><span class="cl-7019af66">275</span></p></td><td class="cl-701c9943"><p class="cl-701c8574"><span class="cl-7019af66">0.160</span></p></td><td class="cl-701c9943"><p class="cl-701c8574"><span class="cl-7019af66">1</span></p></td><td class="cl-701c9943"><p class="cl-701c8574"><span class="cl-7019af66">0.144</span></p></td><td class="cl-701c9943"><p class="cl-701c8574"><span class="cl-7019af66">0.096</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-701c9942"><p class="cl-701c856a"><span class="cl-7019af66">1-2-2</span></p></td><td class="cl-701c9943"><p class="cl-701c8574"><span class="cl-7019af66">130</span></p></td><td class="cl-701c9943"><p class="cl-701c8574"><span class="cl-7019af66">0.076</span></p></td><td class="cl-701c9943"><p class="cl-701c8574"><span class="cl-7019af66">1</span></p></td><td class="cl-701c9943"><p class="cl-701c8574"><span class="cl-7019af66">0.096</span></p></td><td class="cl-701c9943"><p class="cl-701c8574"><span class="cl-7019af66">0.144</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-701c9942"><p class="cl-701c856a"><span class="cl-7019af66">2-1-1</span></p></td><td class="cl-701c9943"><p class="cl-701c8574"><span class="cl-7019af66">34</span></p></td><td class="cl-701c9943"><p class="cl-701c8574"><span class="cl-7019af66">0.020</span></p></td><td class="cl-701c9943"><p class="cl-701c8574"><span class="cl-7019af66">1</span></p></td><td class="cl-701c9943"><p class="cl-701c8574"><span class="cl-7019af66">0.144</span></p></td><td class="cl-701c9943"><p class="cl-701c8574"><span class="cl-7019af66">0.096</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-701c9942"><p class="cl-701c856a"><span class="cl-7019af66">2-1-2</span></p></td><td class="cl-701c9943"><p class="cl-701c8574"><span class="cl-7019af66">19</span></p></td><td class="cl-701c9943"><p class="cl-701c8574"><span class="cl-7019af66">0.011</span></p></td><td class="cl-701c9943"><p class="cl-701c8574"><span class="cl-7019af66">1</span></p></td><td class="cl-701c9943"><p class="cl-701c8574"><span class="cl-7019af66">0.096</span></p></td><td class="cl-701c9943"><p class="cl-701c8574"><span class="cl-7019af66">0.144</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-701c9942"><p class="cl-701c856a"><span class="cl-7019af66">2-2-1</span></p></td><td class="cl-701c9943"><p class="cl-701c8574"><span class="cl-7019af66">125</span></p></td><td class="cl-701c9943"><p class="cl-701c8574"><span class="cl-7019af66">0.073</span></p></td><td class="cl-701c9943"><p class="cl-701c8574"><span class="cl-7019af66">1</span></p></td><td class="cl-701c9943"><p class="cl-701c8574"><span class="cl-7019af66">0.096</span></p></td><td class="cl-701c9943"><p class="cl-701c8574"><span class="cl-7019af66">0.144</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-701c9944"><p class="cl-701c856a"><span class="cl-7019af66">2-2-2</span></p></td><td class="cl-701c9945"><p class="cl-701c8574"><span class="cl-7019af66">366</span></p></td><td class="cl-701c9945"><p class="cl-701c8574"><span class="cl-7019af66">0.214</span></p></td><td class="cl-701c9945"><p class="cl-701c8574"><span class="cl-7019af66">1</span></p></td><td class="cl-701c9945"><p class="cl-701c8574"><span class="cl-7019af66">0.064</span></p></td><td class="cl-701c9945"><p class="cl-701c8574"><span class="cl-7019af66">0.216</span></p></td></tr></tbody></table></div>
</div>
</div>
<p>For each indicator selection pattern, we multiply the posited model probabilities together to get the joint probability of observing that pattern, if the posited parameter values were true. We do that for each posited component.</p>
<div class="page-columns page-full"><p>We then invoke Assumption 1<a href="#fn6" class="footnote-ref" id="fnref6" role="doc-noteref"><sup>6</sup></a> to estimate the observed frequency of the response pattern as the sum of two mixtures.</p><div class="no-row-height column-margin column-container"><li id="fn6"><p><sup>6</sup>&nbsp;<span class="math display">\[
P(y_1, y_2, y_3)=P(X=1)P(y_1, y_2, y_3|X=1) + P(X=2)P(y_1, y_2, y_3|X=2)
\]</span></p></li></div></div>
<div class="cell" data-hash="em-demo--12-Apr-2023-_cache/html/unnamed-chunk-8_8ece3bf298b3951f2bafebd8d3dd9743">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>freqs1 <span class="ot">&lt;-</span> freqs1 <span class="sc">%&gt;%</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">joint_y=</span>joint_x1<span class="sc">*</span>p_x1 <span class="sc">+</span> joint_x2<span class="sc">*</span>p_x2)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="fu">flextable</span>(freqs1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div class="tabwid"><style>.cl-b3b55d7c{}.cl-b3adc5e4{font-family:'Arial';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-b3b0ac8c{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-b3b0ac96{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-b3b0c06e{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-b3b0c078{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-b3b0c079{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-b3b0c082{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-b3b0c083{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-b3b0c084{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing="true" class="cl-b3b55d7c"><thead><tr style="overflow-wrap:break-word;"><th class="cl-b3b0c06e"><p class="cl-b3b0ac8c"><span class="cl-b3adc5e4">val</span></p></th><th class="cl-b3b0c078"><p class="cl-b3b0ac96"><span class="cl-b3adc5e4">frq</span></p></th><th class="cl-b3b0c078"><p class="cl-b3b0ac96"><span class="cl-b3adc5e4">perc</span></p></th><th class="cl-b3b0c078"><p class="cl-b3b0ac96"><span class="cl-b3adc5e4">iteration</span></p></th><th class="cl-b3b0c078"><p class="cl-b3b0ac96"><span class="cl-b3adc5e4">joint_x1</span></p></th><th class="cl-b3b0c078"><p class="cl-b3b0ac96"><span class="cl-b3adc5e4">joint_x2</span></p></th><th class="cl-b3b0c078"><p class="cl-b3b0ac96"><span class="cl-b3adc5e4">joint_y</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-b3b0c079"><p class="cl-b3b0ac8c"><span class="cl-b3adc5e4">1-1-1</span></p></td><td class="cl-b3b0c082"><p class="cl-b3b0ac96"><span class="cl-b3adc5e4">696</span></p></td><td class="cl-b3b0c082"><p class="cl-b3b0ac96"><span class="cl-b3adc5e4">0.406</span></p></td><td class="cl-b3b0c082"><p class="cl-b3b0ac96"><span class="cl-b3adc5e4">1</span></p></td><td class="cl-b3b0c082"><p class="cl-b3b0ac96"><span class="cl-b3adc5e4">0.216</span></p></td><td class="cl-b3b0c082"><p class="cl-b3b0ac96"><span class="cl-b3adc5e4">0.064</span></p></td><td class="cl-b3b0c082"><p class="cl-b3b0ac96"><span class="cl-b3adc5e4">0.14</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-b3b0c079"><p class="cl-b3b0ac8c"><span class="cl-b3adc5e4">1-1-2</span></p></td><td class="cl-b3b0c082"><p class="cl-b3b0ac96"><span class="cl-b3adc5e4">68</span></p></td><td class="cl-b3b0c082"><p class="cl-b3b0ac96"><span class="cl-b3adc5e4">0.040</span></p></td><td class="cl-b3b0c082"><p class="cl-b3b0ac96"><span class="cl-b3adc5e4">1</span></p></td><td class="cl-b3b0c082"><p class="cl-b3b0ac96"><span class="cl-b3adc5e4">0.144</span></p></td><td class="cl-b3b0c082"><p class="cl-b3b0ac96"><span class="cl-b3adc5e4">0.096</span></p></td><td class="cl-b3b0c082"><p class="cl-b3b0ac96"><span class="cl-b3adc5e4">0.12</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-b3b0c079"><p class="cl-b3b0ac8c"><span class="cl-b3adc5e4">1-2-1</span></p></td><td class="cl-b3b0c082"><p class="cl-b3b0ac96"><span class="cl-b3adc5e4">275</span></p></td><td class="cl-b3b0c082"><p class="cl-b3b0ac96"><span class="cl-b3adc5e4">0.160</span></p></td><td class="cl-b3b0c082"><p class="cl-b3b0ac96"><span class="cl-b3adc5e4">1</span></p></td><td class="cl-b3b0c082"><p class="cl-b3b0ac96"><span class="cl-b3adc5e4">0.144</span></p></td><td class="cl-b3b0c082"><p class="cl-b3b0ac96"><span class="cl-b3adc5e4">0.096</span></p></td><td class="cl-b3b0c082"><p class="cl-b3b0ac96"><span class="cl-b3adc5e4">0.12</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-b3b0c079"><p class="cl-b3b0ac8c"><span class="cl-b3adc5e4">1-2-2</span></p></td><td class="cl-b3b0c082"><p class="cl-b3b0ac96"><span class="cl-b3adc5e4">130</span></p></td><td class="cl-b3b0c082"><p class="cl-b3b0ac96"><span class="cl-b3adc5e4">0.076</span></p></td><td class="cl-b3b0c082"><p class="cl-b3b0ac96"><span class="cl-b3adc5e4">1</span></p></td><td class="cl-b3b0c082"><p class="cl-b3b0ac96"><span class="cl-b3adc5e4">0.096</span></p></td><td class="cl-b3b0c082"><p class="cl-b3b0ac96"><span class="cl-b3adc5e4">0.144</span></p></td><td class="cl-b3b0c082"><p class="cl-b3b0ac96"><span class="cl-b3adc5e4">0.12</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-b3b0c079"><p class="cl-b3b0ac8c"><span class="cl-b3adc5e4">2-1-1</span></p></td><td class="cl-b3b0c082"><p class="cl-b3b0ac96"><span class="cl-b3adc5e4">34</span></p></td><td class="cl-b3b0c082"><p class="cl-b3b0ac96"><span class="cl-b3adc5e4">0.020</span></p></td><td class="cl-b3b0c082"><p class="cl-b3b0ac96"><span class="cl-b3adc5e4">1</span></p></td><td class="cl-b3b0c082"><p class="cl-b3b0ac96"><span class="cl-b3adc5e4">0.144</span></p></td><td class="cl-b3b0c082"><p class="cl-b3b0ac96"><span class="cl-b3adc5e4">0.096</span></p></td><td class="cl-b3b0c082"><p class="cl-b3b0ac96"><span class="cl-b3adc5e4">0.12</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-b3b0c079"><p class="cl-b3b0ac8c"><span class="cl-b3adc5e4">2-1-2</span></p></td><td class="cl-b3b0c082"><p class="cl-b3b0ac96"><span class="cl-b3adc5e4">19</span></p></td><td class="cl-b3b0c082"><p class="cl-b3b0ac96"><span class="cl-b3adc5e4">0.011</span></p></td><td class="cl-b3b0c082"><p class="cl-b3b0ac96"><span class="cl-b3adc5e4">1</span></p></td><td class="cl-b3b0c082"><p class="cl-b3b0ac96"><span class="cl-b3adc5e4">0.096</span></p></td><td class="cl-b3b0c082"><p class="cl-b3b0ac96"><span class="cl-b3adc5e4">0.144</span></p></td><td class="cl-b3b0c082"><p class="cl-b3b0ac96"><span class="cl-b3adc5e4">0.12</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-b3b0c079"><p class="cl-b3b0ac8c"><span class="cl-b3adc5e4">2-2-1</span></p></td><td class="cl-b3b0c082"><p class="cl-b3b0ac96"><span class="cl-b3adc5e4">125</span></p></td><td class="cl-b3b0c082"><p class="cl-b3b0ac96"><span class="cl-b3adc5e4">0.073</span></p></td><td class="cl-b3b0c082"><p class="cl-b3b0ac96"><span class="cl-b3adc5e4">1</span></p></td><td class="cl-b3b0c082"><p class="cl-b3b0ac96"><span class="cl-b3adc5e4">0.096</span></p></td><td class="cl-b3b0c082"><p class="cl-b3b0ac96"><span class="cl-b3adc5e4">0.144</span></p></td><td class="cl-b3b0c082"><p class="cl-b3b0ac96"><span class="cl-b3adc5e4">0.12</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-b3b0c083"><p class="cl-b3b0ac8c"><span class="cl-b3adc5e4">2-2-2</span></p></td><td class="cl-b3b0c084"><p class="cl-b3b0ac96"><span class="cl-b3adc5e4">366</span></p></td><td class="cl-b3b0c084"><p class="cl-b3b0ac96"><span class="cl-b3adc5e4">0.214</span></p></td><td class="cl-b3b0c084"><p class="cl-b3b0ac96"><span class="cl-b3adc5e4">1</span></p></td><td class="cl-b3b0c084"><p class="cl-b3b0ac96"><span class="cl-b3adc5e4">0.064</span></p></td><td class="cl-b3b0c084"><p class="cl-b3b0ac96"><span class="cl-b3adc5e4">0.216</span></p></td><td class="cl-b3b0c084"><p class="cl-b3b0ac96"><span class="cl-b3adc5e4">0.14</span></p></td></tr></tbody></table></div>
</div>
</div>
<p>If the parameter estimates are true, then the generated joint probability of the indicator variables (joint_y) should match the observed joint probabilities of the indicator variables (perc). After this first iteration, they are not close.</p>
</section>
<section id="estimate-the-component-probabilities-within-each-component" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="estimate-the-component-probabilities-within-each-component">4. Estimate the component probabilities within each component</h3>
<p>The steps we have taken so far have given us the predicted joint probability of observing a pattern of indicator variables, if the posited parameter values are true. This may be expressed as <span class="math inline">\(P(y|X=c)\)</span>. Recall from the introduction of the EM algorithm is that what we are seeking to estimate, the E step, is <span class="math inline">\(P(X=c|y)\)</span>. This would be an assignation of a probability of belonging to each component <em>c</em>, given the observed response pattern of the indicator variables.</p>
<p>We can apply Bayes Theorem to recover our desired quantity.</p>
<p><span class="math display">\[
P(X=c|y_1, .., y_j)=\frac{P(X=c)P(y_1, .., y_j|X=c)}{P(y_1, .., y_j)}
\]</span></p>
<div class="cell page-columns page-full" data-hash="em-demo--12-Apr-2023-_cache/html/unnamed-chunk-9_7e83c678d1f57b5b304c4de802ad1120">

<div class="no-row-height column-margin column-container"><div class="cell-output-display">

<div class="tabwid"><style>.cl-b49c397c{}.cl-b4957254{font-family:'Arial';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-b4980f50{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-b4980f5a{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-b4981ff4{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-b4981ffe{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-b4981fff{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-b4982000{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-b4982008{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-b4982009{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing="true" class="cl-b49c397c"><thead><tr style="overflow-wrap:break-word;"><th class="cl-b4981ff4"><p class="cl-b4980f50"><span class="cl-b4957254">estimate</span></p></th><th class="cl-b4981ff4"><p class="cl-b4980f50"><span class="cl-b4957254">probs</span></p></th><th class="cl-b4981ffe"><p class="cl-b4980f5a"><span class="cl-b4957254">iteration</span></p></th><th class="cl-b4981ffe"><p class="cl-b4980f5a"><span class="cl-b4957254">X1</span></p></th><th class="cl-b4981ffe"><p class="cl-b4980f5a"><span class="cl-b4957254">X2</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-b4981fff"><p class="cl-b4980f50"><span class="cl-b4957254">current</span></p></td><td class="cl-b4981fff"><p class="cl-b4980f50"><span class="cl-b4957254">P(X)</span></p></td><td class="cl-b4982000"><p class="cl-b4980f5a"><span class="cl-b4957254">1</span></p></td><td class="cl-b4982000"><p class="cl-b4980f5a"><span class="cl-b4957254">0.5</span></p></td><td class="cl-b4982000"><p class="cl-b4980f5a"><span class="cl-b4957254">0.5</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-b4981fff"><p class="cl-b4980f50"><span class="cl-b4957254">current</span></p></td><td class="cl-b4981fff"><p class="cl-b4980f50"><span class="cl-b4957254">P(y1=1|X)</span></p></td><td class="cl-b4982000"><p class="cl-b4980f5a"><span class="cl-b4957254">1</span></p></td><td class="cl-b4982000"><p class="cl-b4980f5a"><span class="cl-b4957254">0.6</span></p></td><td class="cl-b4982000"><p class="cl-b4980f5a"><span class="cl-b4957254">0.4</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-b4981fff"><p class="cl-b4980f50"><span class="cl-b4957254">current</span></p></td><td class="cl-b4981fff"><p class="cl-b4980f50"><span class="cl-b4957254">P(y2=1|X)</span></p></td><td class="cl-b4982000"><p class="cl-b4980f5a"><span class="cl-b4957254">1</span></p></td><td class="cl-b4982000"><p class="cl-b4980f5a"><span class="cl-b4957254">0.6</span></p></td><td class="cl-b4982000"><p class="cl-b4980f5a"><span class="cl-b4957254">0.4</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-b4982008"><p class="cl-b4980f50"><span class="cl-b4957254">current</span></p></td><td class="cl-b4982008"><p class="cl-b4980f50"><span class="cl-b4957254">P(y3=1|X)</span></p></td><td class="cl-b4982009"><p class="cl-b4980f5a"><span class="cl-b4957254">1</span></p></td><td class="cl-b4982009"><p class="cl-b4980f5a"><span class="cl-b4957254">0.6</span></p></td><td class="cl-b4982009"><p class="cl-b4980f5a"><span class="cl-b4957254">0.4</span></p></td></tr></tbody></table></div>
</div></div></div>
<div class="cell" data-hash="em-demo--12-Apr-2023-_cache/html/unnamed-chunk-10_94a7eadbe04acd0510c4ba2bb785f640">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>freqs1 <span class="ot">&lt;-</span> freqs1 <span class="sc">%&gt;%</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">x1_y=</span>(p_x1<span class="sc">*</span>joint_x1)<span class="sc">/</span>joint_y,</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">x2_y=</span>(p_x2<span class="sc">*</span>joint_x2)<span class="sc">/</span>joint_y)</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="fu">flextable</span>(freqs1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div class="tabwid"><style>.cl-b4c51874{}.cl-b4ba4480{font-family:'Arial';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-b4bd510c{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-b4bd5116{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-b4bd61a6{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-b4bd61b0{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-b4bd61b1{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-b4bd61ba{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-b4bd61bb{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-b4bd61bc{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing="true" class="cl-b4c51874"><thead><tr style="overflow-wrap:break-word;"><th class="cl-b4bd61a6"><p class="cl-b4bd510c"><span class="cl-b4ba4480">val</span></p></th><th class="cl-b4bd61b0"><p class="cl-b4bd5116"><span class="cl-b4ba4480">frq</span></p></th><th class="cl-b4bd61b0"><p class="cl-b4bd5116"><span class="cl-b4ba4480">perc</span></p></th><th class="cl-b4bd61b0"><p class="cl-b4bd5116"><span class="cl-b4ba4480">iteration</span></p></th><th class="cl-b4bd61b0"><p class="cl-b4bd5116"><span class="cl-b4ba4480">joint_x1</span></p></th><th class="cl-b4bd61b0"><p class="cl-b4bd5116"><span class="cl-b4ba4480">joint_x2</span></p></th><th class="cl-b4bd61b0"><p class="cl-b4bd5116"><span class="cl-b4ba4480">joint_y</span></p></th><th class="cl-b4bd61b0"><p class="cl-b4bd5116"><span class="cl-b4ba4480">x1_y</span></p></th><th class="cl-b4bd61b0"><p class="cl-b4bd5116"><span class="cl-b4ba4480">x2_y</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-b4bd61b1"><p class="cl-b4bd510c"><span class="cl-b4ba4480">1-1-1</span></p></td><td class="cl-b4bd61ba"><p class="cl-b4bd5116"><span class="cl-b4ba4480">696</span></p></td><td class="cl-b4bd61ba"><p class="cl-b4bd5116"><span class="cl-b4ba4480">0.406</span></p></td><td class="cl-b4bd61ba"><p class="cl-b4bd5116"><span class="cl-b4ba4480">1</span></p></td><td class="cl-b4bd61ba"><p class="cl-b4bd5116"><span class="cl-b4ba4480">0.216</span></p></td><td class="cl-b4bd61ba"><p class="cl-b4bd5116"><span class="cl-b4ba4480">0.064</span></p></td><td class="cl-b4bd61ba"><p class="cl-b4bd5116"><span class="cl-b4ba4480">0.14</span></p></td><td class="cl-b4bd61ba"><p class="cl-b4bd5116"><span class="cl-b4ba4480">0.771</span></p></td><td class="cl-b4bd61ba"><p class="cl-b4bd5116"><span class="cl-b4ba4480">0.229</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-b4bd61b1"><p class="cl-b4bd510c"><span class="cl-b4ba4480">1-1-2</span></p></td><td class="cl-b4bd61ba"><p class="cl-b4bd5116"><span class="cl-b4ba4480">68</span></p></td><td class="cl-b4bd61ba"><p class="cl-b4bd5116"><span class="cl-b4ba4480">0.040</span></p></td><td class="cl-b4bd61ba"><p class="cl-b4bd5116"><span class="cl-b4ba4480">1</span></p></td><td class="cl-b4bd61ba"><p class="cl-b4bd5116"><span class="cl-b4ba4480">0.144</span></p></td><td class="cl-b4bd61ba"><p class="cl-b4bd5116"><span class="cl-b4ba4480">0.096</span></p></td><td class="cl-b4bd61ba"><p class="cl-b4bd5116"><span class="cl-b4ba4480">0.12</span></p></td><td class="cl-b4bd61ba"><p class="cl-b4bd5116"><span class="cl-b4ba4480">0.600</span></p></td><td class="cl-b4bd61ba"><p class="cl-b4bd5116"><span class="cl-b4ba4480">0.400</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-b4bd61b1"><p class="cl-b4bd510c"><span class="cl-b4ba4480">1-2-1</span></p></td><td class="cl-b4bd61ba"><p class="cl-b4bd5116"><span class="cl-b4ba4480">275</span></p></td><td class="cl-b4bd61ba"><p class="cl-b4bd5116"><span class="cl-b4ba4480">0.160</span></p></td><td class="cl-b4bd61ba"><p class="cl-b4bd5116"><span class="cl-b4ba4480">1</span></p></td><td class="cl-b4bd61ba"><p class="cl-b4bd5116"><span class="cl-b4ba4480">0.144</span></p></td><td class="cl-b4bd61ba"><p class="cl-b4bd5116"><span class="cl-b4ba4480">0.096</span></p></td><td class="cl-b4bd61ba"><p class="cl-b4bd5116"><span class="cl-b4ba4480">0.12</span></p></td><td class="cl-b4bd61ba"><p class="cl-b4bd5116"><span class="cl-b4ba4480">0.600</span></p></td><td class="cl-b4bd61ba"><p class="cl-b4bd5116"><span class="cl-b4ba4480">0.400</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-b4bd61b1"><p class="cl-b4bd510c"><span class="cl-b4ba4480">1-2-2</span></p></td><td class="cl-b4bd61ba"><p class="cl-b4bd5116"><span class="cl-b4ba4480">130</span></p></td><td class="cl-b4bd61ba"><p class="cl-b4bd5116"><span class="cl-b4ba4480">0.076</span></p></td><td class="cl-b4bd61ba"><p class="cl-b4bd5116"><span class="cl-b4ba4480">1</span></p></td><td class="cl-b4bd61ba"><p class="cl-b4bd5116"><span class="cl-b4ba4480">0.096</span></p></td><td class="cl-b4bd61ba"><p class="cl-b4bd5116"><span class="cl-b4ba4480">0.144</span></p></td><td class="cl-b4bd61ba"><p class="cl-b4bd5116"><span class="cl-b4ba4480">0.12</span></p></td><td class="cl-b4bd61ba"><p class="cl-b4bd5116"><span class="cl-b4ba4480">0.400</span></p></td><td class="cl-b4bd61ba"><p class="cl-b4bd5116"><span class="cl-b4ba4480">0.600</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-b4bd61b1"><p class="cl-b4bd510c"><span class="cl-b4ba4480">2-1-1</span></p></td><td class="cl-b4bd61ba"><p class="cl-b4bd5116"><span class="cl-b4ba4480">34</span></p></td><td class="cl-b4bd61ba"><p class="cl-b4bd5116"><span class="cl-b4ba4480">0.020</span></p></td><td class="cl-b4bd61ba"><p class="cl-b4bd5116"><span class="cl-b4ba4480">1</span></p></td><td class="cl-b4bd61ba"><p class="cl-b4bd5116"><span class="cl-b4ba4480">0.144</span></p></td><td class="cl-b4bd61ba"><p class="cl-b4bd5116"><span class="cl-b4ba4480">0.096</span></p></td><td class="cl-b4bd61ba"><p class="cl-b4bd5116"><span class="cl-b4ba4480">0.12</span></p></td><td class="cl-b4bd61ba"><p class="cl-b4bd5116"><span class="cl-b4ba4480">0.600</span></p></td><td class="cl-b4bd61ba"><p class="cl-b4bd5116"><span class="cl-b4ba4480">0.400</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-b4bd61b1"><p class="cl-b4bd510c"><span class="cl-b4ba4480">2-1-2</span></p></td><td class="cl-b4bd61ba"><p class="cl-b4bd5116"><span class="cl-b4ba4480">19</span></p></td><td class="cl-b4bd61ba"><p class="cl-b4bd5116"><span class="cl-b4ba4480">0.011</span></p></td><td class="cl-b4bd61ba"><p class="cl-b4bd5116"><span class="cl-b4ba4480">1</span></p></td><td class="cl-b4bd61ba"><p class="cl-b4bd5116"><span class="cl-b4ba4480">0.096</span></p></td><td class="cl-b4bd61ba"><p class="cl-b4bd5116"><span class="cl-b4ba4480">0.144</span></p></td><td class="cl-b4bd61ba"><p class="cl-b4bd5116"><span class="cl-b4ba4480">0.12</span></p></td><td class="cl-b4bd61ba"><p class="cl-b4bd5116"><span class="cl-b4ba4480">0.400</span></p></td><td class="cl-b4bd61ba"><p class="cl-b4bd5116"><span class="cl-b4ba4480">0.600</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-b4bd61b1"><p class="cl-b4bd510c"><span class="cl-b4ba4480">2-2-1</span></p></td><td class="cl-b4bd61ba"><p class="cl-b4bd5116"><span class="cl-b4ba4480">125</span></p></td><td class="cl-b4bd61ba"><p class="cl-b4bd5116"><span class="cl-b4ba4480">0.073</span></p></td><td class="cl-b4bd61ba"><p class="cl-b4bd5116"><span class="cl-b4ba4480">1</span></p></td><td class="cl-b4bd61ba"><p class="cl-b4bd5116"><span class="cl-b4ba4480">0.096</span></p></td><td class="cl-b4bd61ba"><p class="cl-b4bd5116"><span class="cl-b4ba4480">0.144</span></p></td><td class="cl-b4bd61ba"><p class="cl-b4bd5116"><span class="cl-b4ba4480">0.12</span></p></td><td class="cl-b4bd61ba"><p class="cl-b4bd5116"><span class="cl-b4ba4480">0.400</span></p></td><td class="cl-b4bd61ba"><p class="cl-b4bd5116"><span class="cl-b4ba4480">0.600</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-b4bd61bb"><p class="cl-b4bd510c"><span class="cl-b4ba4480">2-2-2</span></p></td><td class="cl-b4bd61bc"><p class="cl-b4bd5116"><span class="cl-b4ba4480">366</span></p></td><td class="cl-b4bd61bc"><p class="cl-b4bd5116"><span class="cl-b4ba4480">0.214</span></p></td><td class="cl-b4bd61bc"><p class="cl-b4bd5116"><span class="cl-b4ba4480">1</span></p></td><td class="cl-b4bd61bc"><p class="cl-b4bd5116"><span class="cl-b4ba4480">0.064</span></p></td><td class="cl-b4bd61bc"><p class="cl-b4bd5116"><span class="cl-b4ba4480">0.216</span></p></td><td class="cl-b4bd61bc"><p class="cl-b4bd5116"><span class="cl-b4ba4480">0.14</span></p></td><td class="cl-b4bd61bc"><p class="cl-b4bd5116"><span class="cl-b4ba4480">0.229</span></p></td><td class="cl-b4bd61bc"><p class="cl-b4bd5116"><span class="cl-b4ba4480">0.771</span></p></td></tr></tbody></table></div>
</div>
</div>
</section>
<section id="estimate-frequency-counts-of-estimated-components" class="level3">
<h3 class="anchored" data-anchor-id="estimate-frequency-counts-of-estimated-components">5. Estimate frequency counts of estimated components</h3>
<p>Using the values of our initial parameter estimates, we have generated estimates of the probability of the respondent belonging to a given component, given their response pattern on the indicator variables. We can now use these estimated probabilities to estimate the number of respondents we expect to belong to each component.</p>
<div class="cell" data-hash="em-demo--12-Apr-2023-_cache/html/unnamed-chunk-11_da9e7f08b7503d0caccbb57d3a8b0a6c">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>freqs1 <span class="ot">&lt;-</span> freqs1 <span class="sc">%&gt;%</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">frq_x1=</span>x1_y<span class="sc">*</span>frq,</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">frq_x2=</span>x2_y<span class="sc">*</span>frq)</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a><span class="fu">flextable</span>(freqs1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div class="tabwid"><style>.cl-b4f5d658{}.cl-b4eebd14{font-family:'Arial';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-b4f15e2a{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-b4f15e34{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-b4f16ec4{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-b4f16ec5{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-b4f16ece{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-b4f16ed8{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-b4f16ed9{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-b4f16ee2{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing="true" class="cl-b4f5d658"><thead><tr style="overflow-wrap:break-word;"><th class="cl-b4f16ec4"><p class="cl-b4f15e2a"><span class="cl-b4eebd14">val</span></p></th><th class="cl-b4f16ec5"><p class="cl-b4f15e34"><span class="cl-b4eebd14">frq</span></p></th><th class="cl-b4f16ec5"><p class="cl-b4f15e34"><span class="cl-b4eebd14">perc</span></p></th><th class="cl-b4f16ec5"><p class="cl-b4f15e34"><span class="cl-b4eebd14">iteration</span></p></th><th class="cl-b4f16ec5"><p class="cl-b4f15e34"><span class="cl-b4eebd14">joint_x1</span></p></th><th class="cl-b4f16ec5"><p class="cl-b4f15e34"><span class="cl-b4eebd14">joint_x2</span></p></th><th class="cl-b4f16ec5"><p class="cl-b4f15e34"><span class="cl-b4eebd14">joint_y</span></p></th><th class="cl-b4f16ec5"><p class="cl-b4f15e34"><span class="cl-b4eebd14">x1_y</span></p></th><th class="cl-b4f16ec5"><p class="cl-b4f15e34"><span class="cl-b4eebd14">x2_y</span></p></th><th class="cl-b4f16ec5"><p class="cl-b4f15e34"><span class="cl-b4eebd14">frq_x1</span></p></th><th class="cl-b4f16ec5"><p class="cl-b4f15e34"><span class="cl-b4eebd14">frq_x2</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-b4f16ece"><p class="cl-b4f15e2a"><span class="cl-b4eebd14">1-1-1</span></p></td><td class="cl-b4f16ed8"><p class="cl-b4f15e34"><span class="cl-b4eebd14">696</span></p></td><td class="cl-b4f16ed8"><p class="cl-b4f15e34"><span class="cl-b4eebd14">0.406</span></p></td><td class="cl-b4f16ed8"><p class="cl-b4f15e34"><span class="cl-b4eebd14">1</span></p></td><td class="cl-b4f16ed8"><p class="cl-b4f15e34"><span class="cl-b4eebd14">0.216</span></p></td><td class="cl-b4f16ed8"><p class="cl-b4f15e34"><span class="cl-b4eebd14">0.064</span></p></td><td class="cl-b4f16ed8"><p class="cl-b4f15e34"><span class="cl-b4eebd14">0.14</span></p></td><td class="cl-b4f16ed8"><p class="cl-b4f15e34"><span class="cl-b4eebd14">0.771</span></p></td><td class="cl-b4f16ed8"><p class="cl-b4f15e34"><span class="cl-b4eebd14">0.229</span></p></td><td class="cl-b4f16ed8"><p class="cl-b4f15e34"><span class="cl-b4eebd14">536.9</span></p></td><td class="cl-b4f16ed8"><p class="cl-b4f15e34"><span class="cl-b4eebd14">159.1</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-b4f16ece"><p class="cl-b4f15e2a"><span class="cl-b4eebd14">1-1-2</span></p></td><td class="cl-b4f16ed8"><p class="cl-b4f15e34"><span class="cl-b4eebd14">68</span></p></td><td class="cl-b4f16ed8"><p class="cl-b4f15e34"><span class="cl-b4eebd14">0.040</span></p></td><td class="cl-b4f16ed8"><p class="cl-b4f15e34"><span class="cl-b4eebd14">1</span></p></td><td class="cl-b4f16ed8"><p class="cl-b4f15e34"><span class="cl-b4eebd14">0.144</span></p></td><td class="cl-b4f16ed8"><p class="cl-b4f15e34"><span class="cl-b4eebd14">0.096</span></p></td><td class="cl-b4f16ed8"><p class="cl-b4f15e34"><span class="cl-b4eebd14">0.12</span></p></td><td class="cl-b4f16ed8"><p class="cl-b4f15e34"><span class="cl-b4eebd14">0.600</span></p></td><td class="cl-b4f16ed8"><p class="cl-b4f15e34"><span class="cl-b4eebd14">0.400</span></p></td><td class="cl-b4f16ed8"><p class="cl-b4f15e34"><span class="cl-b4eebd14">40.8</span></p></td><td class="cl-b4f16ed8"><p class="cl-b4f15e34"><span class="cl-b4eebd14">27.2</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-b4f16ece"><p class="cl-b4f15e2a"><span class="cl-b4eebd14">1-2-1</span></p></td><td class="cl-b4f16ed8"><p class="cl-b4f15e34"><span class="cl-b4eebd14">275</span></p></td><td class="cl-b4f16ed8"><p class="cl-b4f15e34"><span class="cl-b4eebd14">0.160</span></p></td><td class="cl-b4f16ed8"><p class="cl-b4f15e34"><span class="cl-b4eebd14">1</span></p></td><td class="cl-b4f16ed8"><p class="cl-b4f15e34"><span class="cl-b4eebd14">0.144</span></p></td><td class="cl-b4f16ed8"><p class="cl-b4f15e34"><span class="cl-b4eebd14">0.096</span></p></td><td class="cl-b4f16ed8"><p class="cl-b4f15e34"><span class="cl-b4eebd14">0.12</span></p></td><td class="cl-b4f16ed8"><p class="cl-b4f15e34"><span class="cl-b4eebd14">0.600</span></p></td><td class="cl-b4f16ed8"><p class="cl-b4f15e34"><span class="cl-b4eebd14">0.400</span></p></td><td class="cl-b4f16ed8"><p class="cl-b4f15e34"><span class="cl-b4eebd14">165.0</span></p></td><td class="cl-b4f16ed8"><p class="cl-b4f15e34"><span class="cl-b4eebd14">110.0</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-b4f16ece"><p class="cl-b4f15e2a"><span class="cl-b4eebd14">1-2-2</span></p></td><td class="cl-b4f16ed8"><p class="cl-b4f15e34"><span class="cl-b4eebd14">130</span></p></td><td class="cl-b4f16ed8"><p class="cl-b4f15e34"><span class="cl-b4eebd14">0.076</span></p></td><td class="cl-b4f16ed8"><p class="cl-b4f15e34"><span class="cl-b4eebd14">1</span></p></td><td class="cl-b4f16ed8"><p class="cl-b4f15e34"><span class="cl-b4eebd14">0.096</span></p></td><td class="cl-b4f16ed8"><p class="cl-b4f15e34"><span class="cl-b4eebd14">0.144</span></p></td><td class="cl-b4f16ed8"><p class="cl-b4f15e34"><span class="cl-b4eebd14">0.12</span></p></td><td class="cl-b4f16ed8"><p class="cl-b4f15e34"><span class="cl-b4eebd14">0.400</span></p></td><td class="cl-b4f16ed8"><p class="cl-b4f15e34"><span class="cl-b4eebd14">0.600</span></p></td><td class="cl-b4f16ed8"><p class="cl-b4f15e34"><span class="cl-b4eebd14">52.0</span></p></td><td class="cl-b4f16ed8"><p class="cl-b4f15e34"><span class="cl-b4eebd14">78.0</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-b4f16ece"><p class="cl-b4f15e2a"><span class="cl-b4eebd14">2-1-1</span></p></td><td class="cl-b4f16ed8"><p class="cl-b4f15e34"><span class="cl-b4eebd14">34</span></p></td><td class="cl-b4f16ed8"><p class="cl-b4f15e34"><span class="cl-b4eebd14">0.020</span></p></td><td class="cl-b4f16ed8"><p class="cl-b4f15e34"><span class="cl-b4eebd14">1</span></p></td><td class="cl-b4f16ed8"><p class="cl-b4f15e34"><span class="cl-b4eebd14">0.144</span></p></td><td class="cl-b4f16ed8"><p class="cl-b4f15e34"><span class="cl-b4eebd14">0.096</span></p></td><td class="cl-b4f16ed8"><p class="cl-b4f15e34"><span class="cl-b4eebd14">0.12</span></p></td><td class="cl-b4f16ed8"><p class="cl-b4f15e34"><span class="cl-b4eebd14">0.600</span></p></td><td class="cl-b4f16ed8"><p class="cl-b4f15e34"><span class="cl-b4eebd14">0.400</span></p></td><td class="cl-b4f16ed8"><p class="cl-b4f15e34"><span class="cl-b4eebd14">20.4</span></p></td><td class="cl-b4f16ed8"><p class="cl-b4f15e34"><span class="cl-b4eebd14">13.6</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-b4f16ece"><p class="cl-b4f15e2a"><span class="cl-b4eebd14">2-1-2</span></p></td><td class="cl-b4f16ed8"><p class="cl-b4f15e34"><span class="cl-b4eebd14">19</span></p></td><td class="cl-b4f16ed8"><p class="cl-b4f15e34"><span class="cl-b4eebd14">0.011</span></p></td><td class="cl-b4f16ed8"><p class="cl-b4f15e34"><span class="cl-b4eebd14">1</span></p></td><td class="cl-b4f16ed8"><p class="cl-b4f15e34"><span class="cl-b4eebd14">0.096</span></p></td><td class="cl-b4f16ed8"><p class="cl-b4f15e34"><span class="cl-b4eebd14">0.144</span></p></td><td class="cl-b4f16ed8"><p class="cl-b4f15e34"><span class="cl-b4eebd14">0.12</span></p></td><td class="cl-b4f16ed8"><p class="cl-b4f15e34"><span class="cl-b4eebd14">0.400</span></p></td><td class="cl-b4f16ed8"><p class="cl-b4f15e34"><span class="cl-b4eebd14">0.600</span></p></td><td class="cl-b4f16ed8"><p class="cl-b4f15e34"><span class="cl-b4eebd14">7.6</span></p></td><td class="cl-b4f16ed8"><p class="cl-b4f15e34"><span class="cl-b4eebd14">11.4</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-b4f16ece"><p class="cl-b4f15e2a"><span class="cl-b4eebd14">2-2-1</span></p></td><td class="cl-b4f16ed8"><p class="cl-b4f15e34"><span class="cl-b4eebd14">125</span></p></td><td class="cl-b4f16ed8"><p class="cl-b4f15e34"><span class="cl-b4eebd14">0.073</span></p></td><td class="cl-b4f16ed8"><p class="cl-b4f15e34"><span class="cl-b4eebd14">1</span></p></td><td class="cl-b4f16ed8"><p class="cl-b4f15e34"><span class="cl-b4eebd14">0.096</span></p></td><td class="cl-b4f16ed8"><p class="cl-b4f15e34"><span class="cl-b4eebd14">0.144</span></p></td><td class="cl-b4f16ed8"><p class="cl-b4f15e34"><span class="cl-b4eebd14">0.12</span></p></td><td class="cl-b4f16ed8"><p class="cl-b4f15e34"><span class="cl-b4eebd14">0.400</span></p></td><td class="cl-b4f16ed8"><p class="cl-b4f15e34"><span class="cl-b4eebd14">0.600</span></p></td><td class="cl-b4f16ed8"><p class="cl-b4f15e34"><span class="cl-b4eebd14">50.0</span></p></td><td class="cl-b4f16ed8"><p class="cl-b4f15e34"><span class="cl-b4eebd14">75.0</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-b4f16ed9"><p class="cl-b4f15e2a"><span class="cl-b4eebd14">2-2-2</span></p></td><td class="cl-b4f16ee2"><p class="cl-b4f15e34"><span class="cl-b4eebd14">366</span></p></td><td class="cl-b4f16ee2"><p class="cl-b4f15e34"><span class="cl-b4eebd14">0.214</span></p></td><td class="cl-b4f16ee2"><p class="cl-b4f15e34"><span class="cl-b4eebd14">1</span></p></td><td class="cl-b4f16ee2"><p class="cl-b4f15e34"><span class="cl-b4eebd14">0.064</span></p></td><td class="cl-b4f16ee2"><p class="cl-b4f15e34"><span class="cl-b4eebd14">0.216</span></p></td><td class="cl-b4f16ee2"><p class="cl-b4f15e34"><span class="cl-b4eebd14">0.14</span></p></td><td class="cl-b4f16ee2"><p class="cl-b4f15e34"><span class="cl-b4eebd14">0.229</span></p></td><td class="cl-b4f16ee2"><p class="cl-b4f15e34"><span class="cl-b4eebd14">0.771</span></p></td><td class="cl-b4f16ee2"><p class="cl-b4f15e34"><span class="cl-b4eebd14">83.7</span></p></td><td class="cl-b4f16ee2"><p class="cl-b4f15e34"><span class="cl-b4eebd14">282.3</span></p></td></tr></tbody></table></div>
</div>
</div>
<p>Now that we have the predicted frequencies of cases exhibiting a particular response pattern for each component, we will use these probabilities to predict overall frequency counts of the parameters.</p>
<div class="cell" data-hash="em-demo--12-Apr-2023-_cache/html/unnamed-chunk-12_e09f2e591c9ecc7cfa6a82c6cfcde870">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>x1_freqs <span class="ot">&lt;-</span> <span class="fu">sum</span>(freqs1<span class="sc">$</span>frq_x1)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="co">#x1_freqs2</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>x2_freqs <span class="ot">&lt;-</span> <span class="fu">sum</span>(freqs1<span class="sc">$</span>frq_x2)</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a><span class="co">#x2_freqs2</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>f_y1_c1 <span class="ot">&lt;-</span> <span class="fu">sum</span>(freqs1[<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>,<span class="dv">10</span>])</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a><span class="co">#f1_y1_c1</span></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>f_y1_c2 <span class="ot">&lt;-</span> <span class="fu">sum</span>(freqs1[<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>,<span class="dv">11</span>])</span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a><span class="co">#f1_y1_c2</span></span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>f_y2_c1 <span class="ot">&lt;-</span> <span class="fu">sum</span>(freqs1[<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="dv">5</span><span class="sc">:</span><span class="dv">6</span>),<span class="dv">10</span>])</span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a><span class="co">#f1_y2_c1</span></span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a>f_y2_c2 <span class="ot">&lt;-</span> <span class="fu">sum</span>(freqs1[<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="dv">5</span><span class="sc">:</span><span class="dv">6</span>), <span class="dv">11</span>])</span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a><span class="co">#f1_y2_c2</span></span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a>f_y3_c1 <span class="ot">&lt;-</span> <span class="fu">sum</span>(freqs1[<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">7</span>), <span class="dv">10</span>])</span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a><span class="co">#f1_y3_c1</span></span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-22"><a href="#cb11-22" aria-hidden="true" tabindex="-1"></a>f_y3_c2 <span class="ot">&lt;-</span> <span class="fu">sum</span>(freqs1[<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">7</span>), <span class="dv">11</span>])</span>
<span id="cb11-23"><a href="#cb11-23" aria-hidden="true" tabindex="-1"></a><span class="co">#f1_y3_c2</span></span>
<span id="cb11-24"><a href="#cb11-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-25"><a href="#cb11-25" aria-hidden="true" tabindex="-1"></a>newfreqs <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">estimate=</span><span class="st">"new"</span>,</span>
<span id="cb11-26"><a href="#cb11-26" aria-hidden="true" tabindex="-1"></a>                  <span class="at">probs=</span>params1<span class="sc">$</span>probs,</span>
<span id="cb11-27"><a href="#cb11-27" aria-hidden="true" tabindex="-1"></a>                  <span class="at">iteration=</span><span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb11-28"><a href="#cb11-28" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">mutate</span>(<span class="at">X1=</span><span class="fu">c</span>(x1_freqs,</span>
<span id="cb11-29"><a href="#cb11-29" aria-hidden="true" tabindex="-1"></a>                  f_y1_c1,</span>
<span id="cb11-30"><a href="#cb11-30" aria-hidden="true" tabindex="-1"></a>                  f_y2_c1,</span>
<span id="cb11-31"><a href="#cb11-31" aria-hidden="true" tabindex="-1"></a>                  f_y3_c1),</span>
<span id="cb11-32"><a href="#cb11-32" aria-hidden="true" tabindex="-1"></a>                  <span class="at">X2=</span><span class="fu">c</span>(x2_freqs,</span>
<span id="cb11-33"><a href="#cb11-33" aria-hidden="true" tabindex="-1"></a>                  f_y1_c2,</span>
<span id="cb11-34"><a href="#cb11-34" aria-hidden="true" tabindex="-1"></a>                  f_y2_c2,</span>
<span id="cb11-35"><a href="#cb11-35" aria-hidden="true" tabindex="-1"></a>                  f_y3_c2))</span>
<span id="cb11-36"><a href="#cb11-36" aria-hidden="true" tabindex="-1"></a>              </span>
<span id="cb11-37"><a href="#cb11-37" aria-hidden="true" tabindex="-1"></a>newfreqs_flex <span class="ot">&lt;-</span> newfreqs <span class="sc">%&gt;%</span></span>
<span id="cb11-38"><a href="#cb11-38" aria-hidden="true" tabindex="-1"></a><span class="fu">flextable</span>() </span>
<span id="cb11-39"><a href="#cb11-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-40"><a href="#cb11-40" aria-hidden="true" tabindex="-1"></a>newfreqs_flex</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div class="tabwid"><style>.cl-b516fce8{}.cl-b50f525e{font-family:'Arial';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-b5127808{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-b5127812{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-b51287f8{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-b51287f9{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-b5128802{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-b5128803{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-b512880c{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-b512880d{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing="true" class="cl-b516fce8"><thead><tr style="overflow-wrap:break-word;"><th class="cl-b51287f8"><p class="cl-b5127808"><span class="cl-b50f525e">estimate</span></p></th><th class="cl-b51287f8"><p class="cl-b5127808"><span class="cl-b50f525e">probs</span></p></th><th class="cl-b51287f9"><p class="cl-b5127812"><span class="cl-b50f525e">iteration</span></p></th><th class="cl-b51287f9"><p class="cl-b5127812"><span class="cl-b50f525e">X1</span></p></th><th class="cl-b51287f9"><p class="cl-b5127812"><span class="cl-b50f525e">X2</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-b5128802"><p class="cl-b5127808"><span class="cl-b50f525e">new</span></p></td><td class="cl-b5128802"><p class="cl-b5127808"><span class="cl-b50f525e">P(X)</span></p></td><td class="cl-b5128803"><p class="cl-b5127812"><span class="cl-b50f525e">1</span></p></td><td class="cl-b5128803"><p class="cl-b5127812"><span class="cl-b50f525e">956</span></p></td><td class="cl-b5128803"><p class="cl-b5127812"><span class="cl-b50f525e">757</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-b5128802"><p class="cl-b5127808"><span class="cl-b50f525e">new</span></p></td><td class="cl-b5128802"><p class="cl-b5127808"><span class="cl-b50f525e">P(y1=1|X)</span></p></td><td class="cl-b5128803"><p class="cl-b5127812"><span class="cl-b50f525e">1</span></p></td><td class="cl-b5128803"><p class="cl-b5127812"><span class="cl-b50f525e">795</span></p></td><td class="cl-b5128803"><p class="cl-b5127812"><span class="cl-b50f525e">374</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-b5128802"><p class="cl-b5127808"><span class="cl-b50f525e">new</span></p></td><td class="cl-b5128802"><p class="cl-b5127808"><span class="cl-b50f525e">P(y2=1|X)</span></p></td><td class="cl-b5128803"><p class="cl-b5127812"><span class="cl-b50f525e">1</span></p></td><td class="cl-b5128803"><p class="cl-b5127812"><span class="cl-b50f525e">606</span></p></td><td class="cl-b5128803"><p class="cl-b5127812"><span class="cl-b50f525e">211</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-b512880c"><p class="cl-b5127808"><span class="cl-b50f525e">new</span></p></td><td class="cl-b512880c"><p class="cl-b5127808"><span class="cl-b50f525e">P(y3=1|X)</span></p></td><td class="cl-b512880d"><p class="cl-b5127812"><span class="cl-b50f525e">1</span></p></td><td class="cl-b512880d"><p class="cl-b5127812"><span class="cl-b50f525e">772</span></p></td><td class="cl-b512880d"><p class="cl-b5127812"><span class="cl-b50f525e">358</span></p></td></tr></tbody></table></div>
</div>
</div>
</section>
<section id="estimate-new-model-parameters" class="level3">
<h3 class="anchored" data-anchor-id="estimate-new-model-parameters">6. Estimate new model parameters</h3>
<p>Now we use these predicted frequency counts to generate new parameter probabilities</p>
<div class="cell" data-hash="em-demo--12-Apr-2023-_cache/html/unnamed-chunk-13_76aed34f16b7d08aa4d18b64d5670bc4">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>pnew_x1 <span class="ot">&lt;-</span> x1_freqs <span class="sc">/</span> (x1_freqs <span class="sc">+</span> x2_freqs)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="co">#pnew_x1</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>pnew_x2 <span class="ot">&lt;-</span> x2_freqs <span class="sc">/</span> (x1_freqs <span class="sc">+</span> x2_freqs)</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a><span class="co">#pnew_x2</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a><span class="co"># y's for component 1</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>y1_x1 <span class="ot">&lt;-</span> f_y1_c1 <span class="sc">/</span> x1_freqs</span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a><span class="co">#y1_x1</span></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>y2_x1 <span class="ot">&lt;-</span> f_y2_c1 <span class="sc">/</span> x1_freqs</span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a><span class="co">#y2_x1</span></span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>y3_x1 <span class="ot">&lt;-</span> f_y3_c1 <span class="sc">/</span> x1_freqs</span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a><span class="co">#y3_x1</span></span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a><span class="co"># y's for component 2</span></span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a>y1_x2 <span class="ot">&lt;-</span> f_y1_c2 <span class="sc">/</span> x2_freqs</span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a><span class="co">#y1_x2</span></span>
<span id="cb12-22"><a href="#cb12-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-23"><a href="#cb12-23" aria-hidden="true" tabindex="-1"></a>y2_x2 <span class="ot">&lt;-</span> f_y2_c2 <span class="sc">/</span> x2_freqs</span>
<span id="cb12-24"><a href="#cb12-24" aria-hidden="true" tabindex="-1"></a><span class="co">#y2_x2</span></span>
<span id="cb12-25"><a href="#cb12-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-26"><a href="#cb12-26" aria-hidden="true" tabindex="-1"></a>y3_x2 <span class="ot">&lt;-</span> f_y3_c2 <span class="sc">/</span> x2_freqs</span>
<span id="cb12-27"><a href="#cb12-27" aria-hidden="true" tabindex="-1"></a><span class="co">#y3_x2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Arrange new model parameters into a table.</p>
<div class="cell" data-hash="em-demo--12-Apr-2023-_cache/html/unnamed-chunk-14_b4d79de95a86787340a33fada19af7e5">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>new <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">estimate=</span><span class="st">"new"</span>,</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>                  <span class="at">probs=</span>params1<span class="sc">$</span>probs,</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>                  <span class="at">iteration=</span><span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">mutate</span>(<span class="at">X1=</span><span class="fu">c</span>(pnew_x1,</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>                  y1_x1,</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>                  y2_x1,</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>                  y3_x1),</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>                  <span class="at">X2=</span><span class="fu">c</span>(pnew_x2,</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>                  y1_x2,</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>                  y2_x2,</span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>                  y3_x2))</span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>              </span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a><span class="co">#flextable(new)</span></span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>params1 <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(params1, new)</span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a><span class="fu">flextable</span>(params1) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div class="tabwid"><style>.cl-888848f6{}.cl-887fab74{font-family:'Arial';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-88838028{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-88838032{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-88839b58{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-88839b6c{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-88839b6d{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-88839b6e{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-88839b6f{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-88839b76{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing="true" class="cl-888848f6"><thead><tr style="overflow-wrap:break-word;"><th class="cl-88839b58"><p class="cl-88838028"><span class="cl-887fab74">estimate</span></p></th><th class="cl-88839b58"><p class="cl-88838028"><span class="cl-887fab74">probs</span></p></th><th class="cl-88839b6c"><p class="cl-88838032"><span class="cl-887fab74">iteration</span></p></th><th class="cl-88839b6c"><p class="cl-88838032"><span class="cl-887fab74">X1</span></p></th><th class="cl-88839b6c"><p class="cl-88838032"><span class="cl-887fab74">X2</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-88839b6d"><p class="cl-88838028"><span class="cl-887fab74">current</span></p></td><td class="cl-88839b6d"><p class="cl-88838028"><span class="cl-887fab74">P(X)</span></p></td><td class="cl-88839b6e"><p class="cl-88838032"><span class="cl-887fab74">1</span></p></td><td class="cl-88839b6e"><p class="cl-88838032"><span class="cl-887fab74">0.500</span></p></td><td class="cl-88839b6e"><p class="cl-88838032"><span class="cl-887fab74">0.500</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-88839b6d"><p class="cl-88838028"><span class="cl-887fab74">current</span></p></td><td class="cl-88839b6d"><p class="cl-88838028"><span class="cl-887fab74">P(y1=1|X)</span></p></td><td class="cl-88839b6e"><p class="cl-88838032"><span class="cl-887fab74">1</span></p></td><td class="cl-88839b6e"><p class="cl-88838032"><span class="cl-887fab74">0.600</span></p></td><td class="cl-88839b6e"><p class="cl-88838032"><span class="cl-887fab74">0.400</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-88839b6d"><p class="cl-88838028"><span class="cl-887fab74">current</span></p></td><td class="cl-88839b6d"><p class="cl-88838028"><span class="cl-887fab74">P(y2=1|X)</span></p></td><td class="cl-88839b6e"><p class="cl-88838032"><span class="cl-887fab74">1</span></p></td><td class="cl-88839b6e"><p class="cl-88838032"><span class="cl-887fab74">0.600</span></p></td><td class="cl-88839b6e"><p class="cl-88838032"><span class="cl-887fab74">0.400</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-88839b6d"><p class="cl-88838028"><span class="cl-887fab74">current</span></p></td><td class="cl-88839b6d"><p class="cl-88838028"><span class="cl-887fab74">P(y3=1|X)</span></p></td><td class="cl-88839b6e"><p class="cl-88838032"><span class="cl-887fab74">1</span></p></td><td class="cl-88839b6e"><p class="cl-88838032"><span class="cl-887fab74">0.600</span></p></td><td class="cl-88839b6e"><p class="cl-88838032"><span class="cl-887fab74">0.400</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-88839b6d"><p class="cl-88838028"><span class="cl-887fab74">new</span></p></td><td class="cl-88839b6d"><p class="cl-88838028"><span class="cl-887fab74">P(X)</span></p></td><td class="cl-88839b6e"><p class="cl-88838032"><span class="cl-887fab74">1</span></p></td><td class="cl-88839b6e"><p class="cl-88838032"><span class="cl-887fab74">0.558</span></p></td><td class="cl-88839b6e"><p class="cl-88838032"><span class="cl-887fab74">0.442</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-88839b6d"><p class="cl-88838028"><span class="cl-887fab74">new</span></p></td><td class="cl-88839b6d"><p class="cl-88838028"><span class="cl-887fab74">P(y1=1|X)</span></p></td><td class="cl-88839b6e"><p class="cl-88838032"><span class="cl-887fab74">1</span></p></td><td class="cl-88839b6e"><p class="cl-88838032"><span class="cl-887fab74">0.831</span></p></td><td class="cl-88839b6e"><p class="cl-88838032"><span class="cl-887fab74">0.495</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-88839b6d"><p class="cl-88838028"><span class="cl-887fab74">new</span></p></td><td class="cl-88839b6d"><p class="cl-88838028"><span class="cl-887fab74">P(y2=1|X)</span></p></td><td class="cl-88839b6e"><p class="cl-88838032"><span class="cl-887fab74">1</span></p></td><td class="cl-88839b6e"><p class="cl-88838032"><span class="cl-887fab74">0.633</span></p></td><td class="cl-88839b6e"><p class="cl-88838032"><span class="cl-887fab74">0.279</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-88839b6f"><p class="cl-88838028"><span class="cl-887fab74">new</span></p></td><td class="cl-88839b6f"><p class="cl-88838028"><span class="cl-887fab74">P(y3=1|X)</span></p></td><td class="cl-88839b76"><p class="cl-88838032"><span class="cl-887fab74">1</span></p></td><td class="cl-88839b76"><p class="cl-88838032"><span class="cl-887fab74">0.808</span></p></td><td class="cl-88839b76"><p class="cl-88838032"><span class="cl-887fab74">0.473</span></p></td></tr></tbody></table></div>
</div>
</div>
<p>Comparing initial to new estimates of model parameters, we see that the estimate of the share of component 1 in the sample increases to 56 percent, while the estimate of the share of component 2 in the sample decreases to 44 percent. Probability of belonging to component 1 increased for all indicator variables, and decreased for all indicator variables belonging to comnponent 2.</p>
<p>What are we to make of this? There exists a proof that these new estimates better describe the observed data. We know this with certainty if we had known the hidden labels beforehand but blinded them in this analysis. But without the hidden knowledge, how do we know?</p>
<p>We can take the log likelihood of our response patterns at each iteration to see whether we are arriving at some sort of ground-truth. It can be shown that the log likelihood is guaranteed to increase after each iteration of the algorithm.</p>
<div class="cell" data-hash="em-demo--12-Apr-2023-_cache/html/unnamed-chunk-15_cd077c3cfb8e710b200f5225845deca0">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>freqs1 <span class="ot">&lt;-</span> freqs1 <span class="sc">%&gt;%</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ll=</span>frq<span class="sc">*</span><span class="fu">log</span>(joint_y))</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="fu">flextable</span>(freqs1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div class="tabwid"><style>.cl-b57f5bb2{}.cl-b5758f4c{font-family:'Arial';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-b5796f18{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-b5796f22{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-b5797fd0{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-b5797fda{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-b5797fdb{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-b5797fdc{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-b5797fdd{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-b5797fe4{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing="true" class="cl-b57f5bb2"><thead><tr style="overflow-wrap:break-word;"><th class="cl-b5797fd0"><p class="cl-b5796f18"><span class="cl-b5758f4c">val</span></p></th><th class="cl-b5797fda"><p class="cl-b5796f22"><span class="cl-b5758f4c">frq</span></p></th><th class="cl-b5797fda"><p class="cl-b5796f22"><span class="cl-b5758f4c">perc</span></p></th><th class="cl-b5797fda"><p class="cl-b5796f22"><span class="cl-b5758f4c">iteration</span></p></th><th class="cl-b5797fda"><p class="cl-b5796f22"><span class="cl-b5758f4c">joint_x1</span></p></th><th class="cl-b5797fda"><p class="cl-b5796f22"><span class="cl-b5758f4c">joint_x2</span></p></th><th class="cl-b5797fda"><p class="cl-b5796f22"><span class="cl-b5758f4c">joint_y</span></p></th><th class="cl-b5797fda"><p class="cl-b5796f22"><span class="cl-b5758f4c">x1_y</span></p></th><th class="cl-b5797fda"><p class="cl-b5796f22"><span class="cl-b5758f4c">x2_y</span></p></th><th class="cl-b5797fda"><p class="cl-b5796f22"><span class="cl-b5758f4c">frq_x1</span></p></th><th class="cl-b5797fda"><p class="cl-b5796f22"><span class="cl-b5758f4c">frq_x2</span></p></th><th class="cl-b5797fda"><p class="cl-b5796f22"><span class="cl-b5758f4c">ll</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-b5797fdb"><p class="cl-b5796f18"><span class="cl-b5758f4c">1-1-1</span></p></td><td class="cl-b5797fdc"><p class="cl-b5796f22"><span class="cl-b5758f4c">696</span></p></td><td class="cl-b5797fdc"><p class="cl-b5796f22"><span class="cl-b5758f4c">0.406</span></p></td><td class="cl-b5797fdc"><p class="cl-b5796f22"><span class="cl-b5758f4c">1</span></p></td><td class="cl-b5797fdc"><p class="cl-b5796f22"><span class="cl-b5758f4c">0.216</span></p></td><td class="cl-b5797fdc"><p class="cl-b5796f22"><span class="cl-b5758f4c">0.064</span></p></td><td class="cl-b5797fdc"><p class="cl-b5796f22"><span class="cl-b5758f4c">0.14</span></p></td><td class="cl-b5797fdc"><p class="cl-b5796f22"><span class="cl-b5758f4c">0.771</span></p></td><td class="cl-b5797fdc"><p class="cl-b5796f22"><span class="cl-b5758f4c">0.229</span></p></td><td class="cl-b5797fdc"><p class="cl-b5796f22"><span class="cl-b5758f4c">536.9</span></p></td><td class="cl-b5797fdc"><p class="cl-b5796f22"><span class="cl-b5758f4c">159.1</span></p></td><td class="cl-b5797fdc"><p class="cl-b5796f22"><span class="cl-b5758f4c">-1,368.4</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-b5797fdb"><p class="cl-b5796f18"><span class="cl-b5758f4c">1-1-2</span></p></td><td class="cl-b5797fdc"><p class="cl-b5796f22"><span class="cl-b5758f4c">68</span></p></td><td class="cl-b5797fdc"><p class="cl-b5796f22"><span class="cl-b5758f4c">0.040</span></p></td><td class="cl-b5797fdc"><p class="cl-b5796f22"><span class="cl-b5758f4c">1</span></p></td><td class="cl-b5797fdc"><p class="cl-b5796f22"><span class="cl-b5758f4c">0.144</span></p></td><td class="cl-b5797fdc"><p class="cl-b5796f22"><span class="cl-b5758f4c">0.096</span></p></td><td class="cl-b5797fdc"><p class="cl-b5796f22"><span class="cl-b5758f4c">0.12</span></p></td><td class="cl-b5797fdc"><p class="cl-b5796f22"><span class="cl-b5758f4c">0.600</span></p></td><td class="cl-b5797fdc"><p class="cl-b5796f22"><span class="cl-b5758f4c">0.400</span></p></td><td class="cl-b5797fdc"><p class="cl-b5796f22"><span class="cl-b5758f4c">40.8</span></p></td><td class="cl-b5797fdc"><p class="cl-b5796f22"><span class="cl-b5758f4c">27.2</span></p></td><td class="cl-b5797fdc"><p class="cl-b5796f22"><span class="cl-b5758f4c">-144.2</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-b5797fdb"><p class="cl-b5796f18"><span class="cl-b5758f4c">1-2-1</span></p></td><td class="cl-b5797fdc"><p class="cl-b5796f22"><span class="cl-b5758f4c">275</span></p></td><td class="cl-b5797fdc"><p class="cl-b5796f22"><span class="cl-b5758f4c">0.160</span></p></td><td class="cl-b5797fdc"><p class="cl-b5796f22"><span class="cl-b5758f4c">1</span></p></td><td class="cl-b5797fdc"><p class="cl-b5796f22"><span class="cl-b5758f4c">0.144</span></p></td><td class="cl-b5797fdc"><p class="cl-b5796f22"><span class="cl-b5758f4c">0.096</span></p></td><td class="cl-b5797fdc"><p class="cl-b5796f22"><span class="cl-b5758f4c">0.12</span></p></td><td class="cl-b5797fdc"><p class="cl-b5796f22"><span class="cl-b5758f4c">0.600</span></p></td><td class="cl-b5797fdc"><p class="cl-b5796f22"><span class="cl-b5758f4c">0.400</span></p></td><td class="cl-b5797fdc"><p class="cl-b5796f22"><span class="cl-b5758f4c">165.0</span></p></td><td class="cl-b5797fdc"><p class="cl-b5796f22"><span class="cl-b5758f4c">110.0</span></p></td><td class="cl-b5797fdc"><p class="cl-b5796f22"><span class="cl-b5758f4c">-583.1</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-b5797fdb"><p class="cl-b5796f18"><span class="cl-b5758f4c">1-2-2</span></p></td><td class="cl-b5797fdc"><p class="cl-b5796f22"><span class="cl-b5758f4c">130</span></p></td><td class="cl-b5797fdc"><p class="cl-b5796f22"><span class="cl-b5758f4c">0.076</span></p></td><td class="cl-b5797fdc"><p class="cl-b5796f22"><span class="cl-b5758f4c">1</span></p></td><td class="cl-b5797fdc"><p class="cl-b5796f22"><span class="cl-b5758f4c">0.096</span></p></td><td class="cl-b5797fdc"><p class="cl-b5796f22"><span class="cl-b5758f4c">0.144</span></p></td><td class="cl-b5797fdc"><p class="cl-b5796f22"><span class="cl-b5758f4c">0.12</span></p></td><td class="cl-b5797fdc"><p class="cl-b5796f22"><span class="cl-b5758f4c">0.400</span></p></td><td class="cl-b5797fdc"><p class="cl-b5796f22"><span class="cl-b5758f4c">0.600</span></p></td><td class="cl-b5797fdc"><p class="cl-b5796f22"><span class="cl-b5758f4c">52.0</span></p></td><td class="cl-b5797fdc"><p class="cl-b5796f22"><span class="cl-b5758f4c">78.0</span></p></td><td class="cl-b5797fdc"><p class="cl-b5796f22"><span class="cl-b5758f4c">-275.6</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-b5797fdb"><p class="cl-b5796f18"><span class="cl-b5758f4c">2-1-1</span></p></td><td class="cl-b5797fdc"><p class="cl-b5796f22"><span class="cl-b5758f4c">34</span></p></td><td class="cl-b5797fdc"><p class="cl-b5796f22"><span class="cl-b5758f4c">0.020</span></p></td><td class="cl-b5797fdc"><p class="cl-b5796f22"><span class="cl-b5758f4c">1</span></p></td><td class="cl-b5797fdc"><p class="cl-b5796f22"><span class="cl-b5758f4c">0.144</span></p></td><td class="cl-b5797fdc"><p class="cl-b5796f22"><span class="cl-b5758f4c">0.096</span></p></td><td class="cl-b5797fdc"><p class="cl-b5796f22"><span class="cl-b5758f4c">0.12</span></p></td><td class="cl-b5797fdc"><p class="cl-b5796f22"><span class="cl-b5758f4c">0.600</span></p></td><td class="cl-b5797fdc"><p class="cl-b5796f22"><span class="cl-b5758f4c">0.400</span></p></td><td class="cl-b5797fdc"><p class="cl-b5796f22"><span class="cl-b5758f4c">20.4</span></p></td><td class="cl-b5797fdc"><p class="cl-b5796f22"><span class="cl-b5758f4c">13.6</span></p></td><td class="cl-b5797fdc"><p class="cl-b5796f22"><span class="cl-b5758f4c">-72.1</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-b5797fdb"><p class="cl-b5796f18"><span class="cl-b5758f4c">2-1-2</span></p></td><td class="cl-b5797fdc"><p class="cl-b5796f22"><span class="cl-b5758f4c">19</span></p></td><td class="cl-b5797fdc"><p class="cl-b5796f22"><span class="cl-b5758f4c">0.011</span></p></td><td class="cl-b5797fdc"><p class="cl-b5796f22"><span class="cl-b5758f4c">1</span></p></td><td class="cl-b5797fdc"><p class="cl-b5796f22"><span class="cl-b5758f4c">0.096</span></p></td><td class="cl-b5797fdc"><p class="cl-b5796f22"><span class="cl-b5758f4c">0.144</span></p></td><td class="cl-b5797fdc"><p class="cl-b5796f22"><span class="cl-b5758f4c">0.12</span></p></td><td class="cl-b5797fdc"><p class="cl-b5796f22"><span class="cl-b5758f4c">0.400</span></p></td><td class="cl-b5797fdc"><p class="cl-b5796f22"><span class="cl-b5758f4c">0.600</span></p></td><td class="cl-b5797fdc"><p class="cl-b5796f22"><span class="cl-b5758f4c">7.6</span></p></td><td class="cl-b5797fdc"><p class="cl-b5796f22"><span class="cl-b5758f4c">11.4</span></p></td><td class="cl-b5797fdc"><p class="cl-b5796f22"><span class="cl-b5758f4c">-40.3</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-b5797fdb"><p class="cl-b5796f18"><span class="cl-b5758f4c">2-2-1</span></p></td><td class="cl-b5797fdc"><p class="cl-b5796f22"><span class="cl-b5758f4c">125</span></p></td><td class="cl-b5797fdc"><p class="cl-b5796f22"><span class="cl-b5758f4c">0.073</span></p></td><td class="cl-b5797fdc"><p class="cl-b5796f22"><span class="cl-b5758f4c">1</span></p></td><td class="cl-b5797fdc"><p class="cl-b5796f22"><span class="cl-b5758f4c">0.096</span></p></td><td class="cl-b5797fdc"><p class="cl-b5796f22"><span class="cl-b5758f4c">0.144</span></p></td><td class="cl-b5797fdc"><p class="cl-b5796f22"><span class="cl-b5758f4c">0.12</span></p></td><td class="cl-b5797fdc"><p class="cl-b5796f22"><span class="cl-b5758f4c">0.400</span></p></td><td class="cl-b5797fdc"><p class="cl-b5796f22"><span class="cl-b5758f4c">0.600</span></p></td><td class="cl-b5797fdc"><p class="cl-b5796f22"><span class="cl-b5758f4c">50.0</span></p></td><td class="cl-b5797fdc"><p class="cl-b5796f22"><span class="cl-b5758f4c">75.0</span></p></td><td class="cl-b5797fdc"><p class="cl-b5796f22"><span class="cl-b5758f4c">-265.0</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-b5797fdd"><p class="cl-b5796f18"><span class="cl-b5758f4c">2-2-2</span></p></td><td class="cl-b5797fe4"><p class="cl-b5796f22"><span class="cl-b5758f4c">366</span></p></td><td class="cl-b5797fe4"><p class="cl-b5796f22"><span class="cl-b5758f4c">0.214</span></p></td><td class="cl-b5797fe4"><p class="cl-b5796f22"><span class="cl-b5758f4c">1</span></p></td><td class="cl-b5797fe4"><p class="cl-b5796f22"><span class="cl-b5758f4c">0.064</span></p></td><td class="cl-b5797fe4"><p class="cl-b5796f22"><span class="cl-b5758f4c">0.216</span></p></td><td class="cl-b5797fe4"><p class="cl-b5796f22"><span class="cl-b5758f4c">0.14</span></p></td><td class="cl-b5797fe4"><p class="cl-b5796f22"><span class="cl-b5758f4c">0.229</span></p></td><td class="cl-b5797fe4"><p class="cl-b5796f22"><span class="cl-b5758f4c">0.771</span></p></td><td class="cl-b5797fe4"><p class="cl-b5796f22"><span class="cl-b5758f4c">83.7</span></p></td><td class="cl-b5797fe4"><p class="cl-b5796f22"><span class="cl-b5758f4c">282.3</span></p></td><td class="cl-b5797fe4"><p class="cl-b5796f22"><span class="cl-b5758f4c">-719.6</span></p></td></tr></tbody></table></div>
</div>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>ll_1 <span class="ot">&lt;-</span> <span class="fu">sum</span>(freqs1<span class="sc">$</span>ll)</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>ll_1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -3468</code></pre>
</div>
</div>
</section>
</section>
<section id="iterate-the-model" class="level2">
<h2 class="anchored" data-anchor-id="iterate-the-model">Iterate the model</h2>
<p>Let’s now go through the iteration again, using the new model parameter estimates.</p>
<div class="cell" data-hash="em-demo--12-Apr-2023-_cache/html/unnamed-chunk-16_1e544ded0dc927bb20ddc31e83a7dbe3">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>params2 <span class="ot">&lt;-</span> new <span class="sc">%&gt;%</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">estimate=</span><span class="st">"current"</span>,</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">iteration=</span><span class="dv">2</span>)</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a><span class="fu">flextable</span>(params2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div class="tabwid"><style>.cl-8940bae4{}.cl-8939a1c8{font-family:'Arial';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-893c3d02{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-893c3d0c{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-893c4f2c{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-893c4f36{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-893c4f37{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-893c4f40{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-893c4f41{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-893c4f4a{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing="true" class="cl-8940bae4"><thead><tr style="overflow-wrap:break-word;"><th class="cl-893c4f2c"><p class="cl-893c3d02"><span class="cl-8939a1c8">estimate</span></p></th><th class="cl-893c4f2c"><p class="cl-893c3d02"><span class="cl-8939a1c8">probs</span></p></th><th class="cl-893c4f36"><p class="cl-893c3d0c"><span class="cl-8939a1c8">iteration</span></p></th><th class="cl-893c4f36"><p class="cl-893c3d0c"><span class="cl-8939a1c8">X1</span></p></th><th class="cl-893c4f36"><p class="cl-893c3d0c"><span class="cl-8939a1c8">X2</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-893c4f37"><p class="cl-893c3d02"><span class="cl-8939a1c8">current</span></p></td><td class="cl-893c4f37"><p class="cl-893c3d02"><span class="cl-8939a1c8">P(X)</span></p></td><td class="cl-893c4f40"><p class="cl-893c3d0c"><span class="cl-8939a1c8">2</span></p></td><td class="cl-893c4f40"><p class="cl-893c3d0c"><span class="cl-8939a1c8">0.558</span></p></td><td class="cl-893c4f40"><p class="cl-893c3d0c"><span class="cl-8939a1c8">0.442</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-893c4f37"><p class="cl-893c3d02"><span class="cl-8939a1c8">current</span></p></td><td class="cl-893c4f37"><p class="cl-893c3d02"><span class="cl-8939a1c8">P(y1=1|X)</span></p></td><td class="cl-893c4f40"><p class="cl-893c3d0c"><span class="cl-8939a1c8">2</span></p></td><td class="cl-893c4f40"><p class="cl-893c3d0c"><span class="cl-8939a1c8">0.831</span></p></td><td class="cl-893c4f40"><p class="cl-893c3d0c"><span class="cl-8939a1c8">0.495</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-893c4f37"><p class="cl-893c3d02"><span class="cl-8939a1c8">current</span></p></td><td class="cl-893c4f37"><p class="cl-893c3d02"><span class="cl-8939a1c8">P(y2=1|X)</span></p></td><td class="cl-893c4f40"><p class="cl-893c3d0c"><span class="cl-8939a1c8">2</span></p></td><td class="cl-893c4f40"><p class="cl-893c3d0c"><span class="cl-8939a1c8">0.633</span></p></td><td class="cl-893c4f40"><p class="cl-893c3d0c"><span class="cl-8939a1c8">0.279</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-893c4f41"><p class="cl-893c3d02"><span class="cl-8939a1c8">current</span></p></td><td class="cl-893c4f41"><p class="cl-893c3d02"><span class="cl-8939a1c8">P(y3=1|X)</span></p></td><td class="cl-893c4f4a"><p class="cl-893c3d0c"><span class="cl-8939a1c8">2</span></p></td><td class="cl-893c4f4a"><p class="cl-893c3d0c"><span class="cl-8939a1c8">0.808</span></p></td><td class="cl-893c4f4a"><p class="cl-893c3d0c"><span class="cl-8939a1c8">0.473</span></p></td></tr></tbody></table></div>
</div>
</div>
<div class="cell" data-hash="em-demo--12-Apr-2023-_cache/html/unnamed-chunk-17_f3c1668495298951ff559c72fe4d8eb9">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>p_x1 <span class="ot">&lt;-</span> params2[<span class="dv">1</span>,<span class="dv">4</span>] <span class="co"># share of component 1</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>p_x2 <span class="ot">&lt;-</span> params2[<span class="dv">1</span>,<span class="dv">5</span>]</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>y1_x1 <span class="ot">&lt;-</span> params2[<span class="dv">2</span>,<span class="dv">4</span>] <span class="co"># probability of y1 for component 1</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>y2_x1 <span class="ot">&lt;-</span> params2[<span class="dv">3</span>,<span class="dv">4</span>]</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>y3_x1 <span class="ot">&lt;-</span> params2[<span class="dv">4</span>,<span class="dv">4</span>]</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>y1_x2 <span class="ot">&lt;-</span> params2[<span class="dv">2</span>,<span class="dv">5</span>] <span class="co"># probability of y1 for component 2</span></span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>y2_x2 <span class="ot">&lt;-</span> params2[<span class="dv">3</span>,<span class="dv">5</span>]</span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>y3_x2 <span class="ot">&lt;-</span> params2[<span class="dv">4</span>,<span class="dv">5</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Probability of response patterns, if they belonged to component 1.</p>
<div class="cell" data-hash="em-demo--12-Apr-2023-_cache/html/unnamed-chunk-18_7a6e303fae9046a3480c6d3d02e1a078">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>x1_111 <span class="ot">&lt;-</span> y1_x1<span class="sc">*</span>y2_x1<span class="sc">*</span>y3_x1 </span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="co"># probability of 1-1-1 belonging to component 1</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>x1_112 <span class="ot">&lt;-</span> y1_x1<span class="sc">*</span>y1_x1<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>y3_x1)</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a><span class="co"># probability of 1-1-2 belonging to component 1</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>x1_121 <span class="ot">&lt;-</span> y1_x1<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>y2_x1)<span class="sc">*</span>y3_x1</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a><span class="co"># probability of 1-2-1 belonging to component 1</span></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>x1_122 <span class="ot">&lt;-</span> y1_x1<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>y2_x1)<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>y3_x1)</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>x1_211 <span class="ot">&lt;-</span> (<span class="dv">1</span><span class="sc">-</span>y1_x1)<span class="sc">*</span>y2_x1<span class="sc">*</span>y3_x1</span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>x1_212 <span class="ot">&lt;-</span> (<span class="dv">1</span><span class="sc">-</span>y1_x1)<span class="sc">*</span>y2_x1<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>y3_x1)</span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>x1_221 <span class="ot">&lt;-</span> (<span class="dv">1</span><span class="sc">-</span>y1_x1)<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>y2_x1)<span class="sc">*</span>(y3_x1)</span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>x1_222 <span class="ot">&lt;-</span> (<span class="dv">1</span><span class="sc">-</span>y1_x1)<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>y2_x1)<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>y3_x1)</span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a>jointy_x1 <span class="ot">&lt;-</span> <span class="fu">c</span>(x1_111, x1_112, x1_121, x1_122, x1_211, x1_212, x1_221, x1_222)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Probability of response patterns, if they belonged to component 2.</p>
<div class="cell" data-hash="em-demo--12-Apr-2023-_cache/html/unnamed-chunk-19_ddf7b4e63983952f24738336f3fc15a0">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>x2_111 <span class="ot">&lt;-</span> y1_x2<span class="sc">*</span>y2_x2<span class="sc">*</span>y3_x2 </span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="co"># probability of 1-1-1 belonging to component 1</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>x2_112 <span class="ot">&lt;-</span> y1_x2<span class="sc">*</span>y1_x2<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>y3_x2)</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a><span class="co"># probability of 1-1-2 belonging to component 1</span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>x2_121 <span class="ot">&lt;-</span> y1_x2<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>y2_x2)<span class="sc">*</span>y3_x2</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a><span class="co"># probability of 1-2-1 belonging to component 1</span></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>x2_122 <span class="ot">&lt;-</span> y1_x2<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>y2_x2)<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>y3_x2)</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>x2_211 <span class="ot">&lt;-</span> (<span class="dv">1</span><span class="sc">-</span>y1_x2)<span class="sc">*</span>y2_x2<span class="sc">*</span>y3_x2</span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>x2_212 <span class="ot">&lt;-</span> (<span class="dv">1</span><span class="sc">-</span>y1_x2)<span class="sc">*</span>y2_x2<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>y3_x2)</span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>x2_221 <span class="ot">&lt;-</span> (<span class="dv">1</span><span class="sc">-</span>y1_x2)<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>y2_x2)<span class="sc">*</span>(y3_x2)</span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>x2_222 <span class="ot">&lt;-</span> (<span class="dv">1</span><span class="sc">-</span>y1_x2)<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>y2_x2)<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>y3_x2)</span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a>jointy_x2 <span class="ot">&lt;-</span> <span class="fu">c</span>(x2_111, x2_112, x2_121, x2_122, x2_211, x2_212, x2_221, x2_222)</span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a>freqs2 <span class="ot">&lt;-</span> freqs <span class="sc">%&gt;%</span></span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">iteration=</span><span class="dv">2</span>,</span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a>         <span class="at">joint_x1=</span>jointy_x1,</span>
<span id="cb20-18"><a href="#cb20-18" aria-hidden="true" tabindex="-1"></a>         <span class="at">joint_x2=</span>jointy_x2,</span>
<span id="cb20-19"><a href="#cb20-19" aria-hidden="true" tabindex="-1"></a>         <span class="at">joint_y=</span>joint_x1<span class="sc">*</span>p_x1 <span class="sc">+</span> joint_x2<span class="sc">*</span>p_x2,</span>
<span id="cb20-20"><a href="#cb20-20" aria-hidden="true" tabindex="-1"></a>         <span class="at">x1_y=</span>(p_x1<span class="sc">*</span>joint_x1)<span class="sc">/</span>joint_y,</span>
<span id="cb20-21"><a href="#cb20-21" aria-hidden="true" tabindex="-1"></a>         <span class="at">x2_y=</span>(p_x2<span class="sc">*</span>joint_x2)<span class="sc">/</span>joint_y,</span>
<span id="cb20-22"><a href="#cb20-22" aria-hidden="true" tabindex="-1"></a>         <span class="at">frq_x1=</span>x1_y<span class="sc">*</span>frq,</span>
<span id="cb20-23"><a href="#cb20-23" aria-hidden="true" tabindex="-1"></a>         <span class="at">frq_x2=</span>x2_y<span class="sc">*</span>frq)</span>
<span id="cb20-24"><a href="#cb20-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-25"><a href="#cb20-25" aria-hidden="true" tabindex="-1"></a><span class="fu">flextable</span>(freqs2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div class="tabwid"><style>.cl-898b2b4c{}.cl-89841500{font-family:'Arial';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-8986d952{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-8986d966{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-8986e8f2{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8986e8fc{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8986e8fd{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8986e8fe{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8986e906{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8986e910{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing="true" class="cl-898b2b4c"><thead><tr style="overflow-wrap:break-word;"><th class="cl-8986e8f2"><p class="cl-8986d952"><span class="cl-89841500">val</span></p></th><th class="cl-8986e8fc"><p class="cl-8986d966"><span class="cl-89841500">frq</span></p></th><th class="cl-8986e8fc"><p class="cl-8986d966"><span class="cl-89841500">perc</span></p></th><th class="cl-8986e8fc"><p class="cl-8986d966"><span class="cl-89841500">iteration</span></p></th><th class="cl-8986e8fc"><p class="cl-8986d966"><span class="cl-89841500">joint_x1</span></p></th><th class="cl-8986e8fc"><p class="cl-8986d966"><span class="cl-89841500">joint_x2</span></p></th><th class="cl-8986e8fc"><p class="cl-8986d966"><span class="cl-89841500">joint_y</span></p></th><th class="cl-8986e8fc"><p class="cl-8986d966"><span class="cl-89841500">x1_y</span></p></th><th class="cl-8986e8fc"><p class="cl-8986d966"><span class="cl-89841500">x2_y</span></p></th><th class="cl-8986e8fc"><p class="cl-8986d966"><span class="cl-89841500">frq_x1</span></p></th><th class="cl-8986e8fc"><p class="cl-8986d966"><span class="cl-89841500">frq_x2</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-8986e8fd"><p class="cl-8986d952"><span class="cl-89841500">1-1-1</span></p></td><td class="cl-8986e8fe"><p class="cl-8986d966"><span class="cl-89841500">696</span></p></td><td class="cl-8986e8fe"><p class="cl-8986d966"><span class="cl-89841500">0.406</span></p></td><td class="cl-8986e8fe"><p class="cl-8986d966"><span class="cl-89841500">2</span></p></td><td class="cl-8986e8fe"><p class="cl-8986d966"><span class="cl-89841500">0.4250</span></p></td><td class="cl-8986e8fe"><p class="cl-8986d966"><span class="cl-89841500">0.0653</span></p></td><td class="cl-8986e8fe"><p class="cl-8986d966"><span class="cl-89841500">0.2661</span></p></td><td class="cl-8986e8fe"><p class="cl-8986d966"><span class="cl-89841500">0.8916</span></p></td><td class="cl-8986e8fe"><p class="cl-8986d966"><span class="cl-89841500">0.108</span></p></td><td class="cl-8986e8fe"><p class="cl-8986d966"><span class="cl-89841500">620.56</span></p></td><td class="cl-8986e8fe"><p class="cl-8986d966"><span class="cl-89841500">75.4</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-8986e8fd"><p class="cl-8986d952"><span class="cl-89841500">1-1-2</span></p></td><td class="cl-8986e8fe"><p class="cl-8986d966"><span class="cl-89841500">68</span></p></td><td class="cl-8986e8fe"><p class="cl-8986d966"><span class="cl-89841500">0.040</span></p></td><td class="cl-8986e8fe"><p class="cl-8986d966"><span class="cl-89841500">2</span></p></td><td class="cl-8986e8fe"><p class="cl-8986d966"><span class="cl-89841500">0.1329</span></p></td><td class="cl-8986e8fe"><p class="cl-8986d966"><span class="cl-89841500">0.1290</span></p></td><td class="cl-8986e8fe"><p class="cl-8986d966"><span class="cl-89841500">0.1312</span></p></td><td class="cl-8986e8fe"><p class="cl-8986d966"><span class="cl-89841500">0.5656</span></p></td><td class="cl-8986e8fe"><p class="cl-8986d966"><span class="cl-89841500">0.434</span></p></td><td class="cl-8986e8fe"><p class="cl-8986d966"><span class="cl-89841500">38.46</span></p></td><td class="cl-8986e8fe"><p class="cl-8986d966"><span class="cl-89841500">29.5</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-8986e8fd"><p class="cl-8986d952"><span class="cl-89841500">1-2-1</span></p></td><td class="cl-8986e8fe"><p class="cl-8986d966"><span class="cl-89841500">275</span></p></td><td class="cl-8986e8fe"><p class="cl-8986d966"><span class="cl-89841500">0.160</span></p></td><td class="cl-8986e8fe"><p class="cl-8986d966"><span class="cl-89841500">2</span></p></td><td class="cl-8986e8fe"><p class="cl-8986d966"><span class="cl-89841500">0.2460</span></p></td><td class="cl-8986e8fe"><p class="cl-8986d966"><span class="cl-89841500">0.1685</span></p></td><td class="cl-8986e8fe"><p class="cl-8986d966"><span class="cl-89841500">0.2118</span></p></td><td class="cl-8986e8fe"><p class="cl-8986d966"><span class="cl-89841500">0.6485</span></p></td><td class="cl-8986e8fe"><p class="cl-8986d966"><span class="cl-89841500">0.351</span></p></td><td class="cl-8986e8fe"><p class="cl-8986d966"><span class="cl-89841500">178.34</span></p></td><td class="cl-8986e8fe"><p class="cl-8986d966"><span class="cl-89841500">96.7</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-8986e8fd"><p class="cl-8986d952"><span class="cl-89841500">1-2-2</span></p></td><td class="cl-8986e8fe"><p class="cl-8986d966"><span class="cl-89841500">130</span></p></td><td class="cl-8986e8fe"><p class="cl-8986d966"><span class="cl-89841500">0.076</span></p></td><td class="cl-8986e8fe"><p class="cl-8986d966"><span class="cl-89841500">2</span></p></td><td class="cl-8986e8fe"><p class="cl-8986d966"><span class="cl-89841500">0.0586</span></p></td><td class="cl-8986e8fe"><p class="cl-8986d966"><span class="cl-89841500">0.1880</span></p></td><td class="cl-8986e8fe"><p class="cl-8986d966"><span class="cl-89841500">0.1158</span></p></td><td class="cl-8986e8fe"><p class="cl-8986d966"><span class="cl-89841500">0.2828</span></p></td><td class="cl-8986e8fe"><p class="cl-8986d966"><span class="cl-89841500">0.717</span></p></td><td class="cl-8986e8fe"><p class="cl-8986d966"><span class="cl-89841500">36.76</span></p></td><td class="cl-8986e8fe"><p class="cl-8986d966"><span class="cl-89841500">93.2</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-8986e8fd"><p class="cl-8986d952"><span class="cl-89841500">2-1-1</span></p></td><td class="cl-8986e8fe"><p class="cl-8986d966"><span class="cl-89841500">34</span></p></td><td class="cl-8986e8fe"><p class="cl-8986d966"><span class="cl-89841500">0.020</span></p></td><td class="cl-8986e8fe"><p class="cl-8986d966"><span class="cl-89841500">2</span></p></td><td class="cl-8986e8fe"><p class="cl-8986d966"><span class="cl-89841500">0.0865</span></p></td><td class="cl-8986e8fe"><p class="cl-8986d966"><span class="cl-89841500">0.0667</span></p></td><td class="cl-8986e8fe"><p class="cl-8986d966"><span class="cl-89841500">0.0777</span></p></td><td class="cl-8986e8fe"><p class="cl-8986d966"><span class="cl-89841500">0.6209</span></p></td><td class="cl-8986e8fe"><p class="cl-8986d966"><span class="cl-89841500">0.379</span></p></td><td class="cl-8986e8fe"><p class="cl-8986d966"><span class="cl-89841500">21.11</span></p></td><td class="cl-8986e8fe"><p class="cl-8986d966"><span class="cl-89841500">12.9</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-8986e8fd"><p class="cl-8986d952"><span class="cl-89841500">2-1-2</span></p></td><td class="cl-8986e8fe"><p class="cl-8986d966"><span class="cl-89841500">19</span></p></td><td class="cl-8986e8fe"><p class="cl-8986d966"><span class="cl-89841500">0.011</span></p></td><td class="cl-8986e8fe"><p class="cl-8986d966"><span class="cl-89841500">2</span></p></td><td class="cl-8986e8fe"><p class="cl-8986d966"><span class="cl-89841500">0.0206</span></p></td><td class="cl-8986e8fe"><p class="cl-8986d966"><span class="cl-89841500">0.0744</span></p></td><td class="cl-8986e8fe"><p class="cl-8986d966"><span class="cl-89841500">0.0444</span></p></td><td class="cl-8986e8fe"><p class="cl-8986d966"><span class="cl-89841500">0.2593</span></p></td><td class="cl-8986e8fe"><p class="cl-8986d966"><span class="cl-89841500">0.741</span></p></td><td class="cl-8986e8fe"><p class="cl-8986d966"><span class="cl-89841500">4.93</span></p></td><td class="cl-8986e8fe"><p class="cl-8986d966"><span class="cl-89841500">14.1</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-8986e8fd"><p class="cl-8986d952"><span class="cl-89841500">2-2-1</span></p></td><td class="cl-8986e8fe"><p class="cl-8986d966"><span class="cl-89841500">125</span></p></td><td class="cl-8986e8fe"><p class="cl-8986d966"><span class="cl-89841500">0.073</span></p></td><td class="cl-8986e8fe"><p class="cl-8986d966"><span class="cl-89841500">2</span></p></td><td class="cl-8986e8fe"><p class="cl-8986d966"><span class="cl-89841500">0.0500</span></p></td><td class="cl-8986e8fe"><p class="cl-8986d966"><span class="cl-89841500">0.1722</span></p></td><td class="cl-8986e8fe"><p class="cl-8986d966"><span class="cl-89841500">0.1040</span></p></td><td class="cl-8986e8fe"><p class="cl-8986d966"><span class="cl-89841500">0.2687</span></p></td><td class="cl-8986e8fe"><p class="cl-8986d966"><span class="cl-89841500">0.731</span></p></td><td class="cl-8986e8fe"><p class="cl-8986d966"><span class="cl-89841500">33.59</span></p></td><td class="cl-8986e8fe"><p class="cl-8986d966"><span class="cl-89841500">91.4</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-8986e906"><p class="cl-8986d952"><span class="cl-89841500">2-2-2</span></p></td><td class="cl-8986e910"><p class="cl-8986d966"><span class="cl-89841500">366</span></p></td><td class="cl-8986e910"><p class="cl-8986d966"><span class="cl-89841500">0.214</span></p></td><td class="cl-8986e910"><p class="cl-8986d966"><span class="cl-89841500">2</span></p></td><td class="cl-8986e910"><p class="cl-8986d966"><span class="cl-89841500">0.0119</span></p></td><td class="cl-8986e910"><p class="cl-8986d966"><span class="cl-89841500">0.1920</span></p></td><td class="cl-8986e910"><p class="cl-8986d966"><span class="cl-89841500">0.0915</span></p></td><td class="cl-8986e910"><p class="cl-8986d966"><span class="cl-89841500">0.0728</span></p></td><td class="cl-8986e910"><p class="cl-8986d966"><span class="cl-89841500">0.927</span></p></td><td class="cl-8986e910"><p class="cl-8986d966"><span class="cl-89841500">26.64</span></p></td><td class="cl-8986e910"><p class="cl-8986d966"><span class="cl-89841500">339.4</span></p></td></tr></tbody></table></div>
</div>
</div>
<div class="cell" data-hash="em-demo--12-Apr-2023-_cache/html/unnamed-chunk-20_11769e0de42edc3402ee98def808a11a">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>x1_freqs <span class="ot">&lt;-</span> <span class="fu">sum</span>(freqs2<span class="sc">$</span>frq_x1)</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="co">#x1_freqs2</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>x2_freqs <span class="ot">&lt;-</span> <span class="fu">sum</span>(freqs2<span class="sc">$</span>frq_x2)</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a><span class="co">#x2_freqs2</span></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>f_y1_c1 <span class="ot">&lt;-</span> <span class="fu">sum</span>(freqs2[<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>,<span class="dv">10</span>])</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a><span class="co">#f1_y1_c1</span></span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>f_y1_c2 <span class="ot">&lt;-</span> <span class="fu">sum</span>(freqs2[<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>,<span class="dv">11</span>])</span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a><span class="co">#f1_y1_c2</span></span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a>f_y2_c1 <span class="ot">&lt;-</span> <span class="fu">sum</span>(freqs2[<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="dv">5</span><span class="sc">:</span><span class="dv">6</span>),<span class="dv">10</span>])</span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a><span class="co">#f1_y2_c1</span></span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a>f_y2_c2 <span class="ot">&lt;-</span> <span class="fu">sum</span>(freqs2[<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="dv">5</span><span class="sc">:</span><span class="dv">6</span>), <span class="dv">11</span>])</span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a><span class="co">#f1_y2_c2</span></span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-19"><a href="#cb21-19" aria-hidden="true" tabindex="-1"></a>f_y3_c1 <span class="ot">&lt;-</span> <span class="fu">sum</span>(freqs2[<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">7</span>), <span class="dv">10</span>])</span>
<span id="cb21-20"><a href="#cb21-20" aria-hidden="true" tabindex="-1"></a><span class="co">#f1_y3_c1</span></span>
<span id="cb21-21"><a href="#cb21-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-22"><a href="#cb21-22" aria-hidden="true" tabindex="-1"></a>f_y3_c2 <span class="ot">&lt;-</span> <span class="fu">sum</span>(freqs2[<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">7</span>), <span class="dv">11</span>])</span>
<span id="cb21-23"><a href="#cb21-23" aria-hidden="true" tabindex="-1"></a><span class="co">#f1_y3_c2</span></span>
<span id="cb21-24"><a href="#cb21-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-25"><a href="#cb21-25" aria-hidden="true" tabindex="-1"></a>newfreqs <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">estimate=</span><span class="st">"new"</span>,</span>
<span id="cb21-26"><a href="#cb21-26" aria-hidden="true" tabindex="-1"></a>                  <span class="at">probs=</span>params2<span class="sc">$</span>probs,</span>
<span id="cb21-27"><a href="#cb21-27" aria-hidden="true" tabindex="-1"></a>                  <span class="at">iteration=</span><span class="dv">2</span>) <span class="sc">%&gt;%</span></span>
<span id="cb21-28"><a href="#cb21-28" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">mutate</span>(<span class="at">X1=</span><span class="fu">c</span>(x1_freqs,</span>
<span id="cb21-29"><a href="#cb21-29" aria-hidden="true" tabindex="-1"></a>                  f_y1_c1,</span>
<span id="cb21-30"><a href="#cb21-30" aria-hidden="true" tabindex="-1"></a>                  f_y2_c1,</span>
<span id="cb21-31"><a href="#cb21-31" aria-hidden="true" tabindex="-1"></a>                  f_y3_c1),</span>
<span id="cb21-32"><a href="#cb21-32" aria-hidden="true" tabindex="-1"></a>                  <span class="at">X2=</span><span class="fu">c</span>(x2_freqs,</span>
<span id="cb21-33"><a href="#cb21-33" aria-hidden="true" tabindex="-1"></a>                  f_y1_c2,</span>
<span id="cb21-34"><a href="#cb21-34" aria-hidden="true" tabindex="-1"></a>                  f_y2_c2,</span>
<span id="cb21-35"><a href="#cb21-35" aria-hidden="true" tabindex="-1"></a>                  f_y3_c2))</span>
<span id="cb21-36"><a href="#cb21-36" aria-hidden="true" tabindex="-1"></a>              </span>
<span id="cb21-37"><a href="#cb21-37" aria-hidden="true" tabindex="-1"></a>newfreqs_flex <span class="ot">&lt;-</span> newfreqs <span class="sc">%&gt;%</span></span>
<span id="cb21-38"><a href="#cb21-38" aria-hidden="true" tabindex="-1"></a><span class="fu">flextable</span>() </span>
<span id="cb21-39"><a href="#cb21-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-40"><a href="#cb21-40" aria-hidden="true" tabindex="-1"></a>newfreqs_flex</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div class="tabwid"><style>.cl-89a8d0fc{}.cl-89a1981e{font-family:'Arial';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-89a47b7e{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-89a47b88{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-89a48ba0{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-89a48baa{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-89a48bab{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-89a48bb4{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-89a48bb5{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-89a48bb6{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing="true" class="cl-89a8d0fc"><thead><tr style="overflow-wrap:break-word;"><th class="cl-89a48ba0"><p class="cl-89a47b7e"><span class="cl-89a1981e">estimate</span></p></th><th class="cl-89a48ba0"><p class="cl-89a47b7e"><span class="cl-89a1981e">probs</span></p></th><th class="cl-89a48baa"><p class="cl-89a47b88"><span class="cl-89a1981e">iteration</span></p></th><th class="cl-89a48baa"><p class="cl-89a47b88"><span class="cl-89a1981e">X1</span></p></th><th class="cl-89a48baa"><p class="cl-89a47b88"><span class="cl-89a1981e">X2</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-89a48bab"><p class="cl-89a47b7e"><span class="cl-89a1981e">new</span></p></td><td class="cl-89a48bab"><p class="cl-89a47b7e"><span class="cl-89a1981e">P(X)</span></p></td><td class="cl-89a48bb4"><p class="cl-89a47b88"><span class="cl-89a1981e">2</span></p></td><td class="cl-89a48bb4"><p class="cl-89a47b88"><span class="cl-89a1981e">960</span></p></td><td class="cl-89a48bb4"><p class="cl-89a47b88"><span class="cl-89a1981e">753</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-89a48bab"><p class="cl-89a47b7e"><span class="cl-89a1981e">new</span></p></td><td class="cl-89a48bab"><p class="cl-89a47b7e"><span class="cl-89a1981e">P(y1=1|X)</span></p></td><td class="cl-89a48bb4"><p class="cl-89a47b88"><span class="cl-89a1981e">2</span></p></td><td class="cl-89a48bb4"><p class="cl-89a47b88"><span class="cl-89a1981e">874</span></p></td><td class="cl-89a48bb4"><p class="cl-89a47b88"><span class="cl-89a1981e">295</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-89a48bab"><p class="cl-89a47b7e"><span class="cl-89a1981e">new</span></p></td><td class="cl-89a48bab"><p class="cl-89a47b7e"><span class="cl-89a1981e">P(y2=1|X)</span></p></td><td class="cl-89a48bb4"><p class="cl-89a47b88"><span class="cl-89a1981e">2</span></p></td><td class="cl-89a48bb4"><p class="cl-89a47b88"><span class="cl-89a1981e">685</span></p></td><td class="cl-89a48bb4"><p class="cl-89a47b88"><span class="cl-89a1981e">132</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-89a48bb5"><p class="cl-89a47b7e"><span class="cl-89a1981e">new</span></p></td><td class="cl-89a48bb5"><p class="cl-89a47b7e"><span class="cl-89a1981e">P(y3=1|X)</span></p></td><td class="cl-89a48bb6"><p class="cl-89a47b88"><span class="cl-89a1981e">2</span></p></td><td class="cl-89a48bb6"><p class="cl-89a47b88"><span class="cl-89a1981e">854</span></p></td><td class="cl-89a48bb6"><p class="cl-89a47b88"><span class="cl-89a1981e">276</span></p></td></tr></tbody></table></div>
</div>
</div>
<div class="cell" data-hash="em-demo--12-Apr-2023-_cache/html/unnamed-chunk-21_f2906776c214dcc283d581ce1a6ec001">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>pnew_x1 <span class="ot">&lt;-</span> x1_freqs <span class="sc">/</span> (x1_freqs <span class="sc">+</span> x2_freqs)</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="co">#pnew_x1</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>pnew_x2 <span class="ot">&lt;-</span> x2_freqs <span class="sc">/</span> (x1_freqs <span class="sc">+</span> x2_freqs)</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a><span class="co">#pnew_x2</span></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a><span class="co"># y's for component 1</span></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>y1_x1 <span class="ot">&lt;-</span> f_y1_c1 <span class="sc">/</span> x1_freqs</span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a><span class="co">#y1_x1</span></span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>y2_x1 <span class="ot">&lt;-</span> f_y2_c1 <span class="sc">/</span> x1_freqs</span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a><span class="co">#y2_x1</span></span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a>y3_x1 <span class="ot">&lt;-</span> f_y3_c1 <span class="sc">/</span> x1_freqs</span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a><span class="co">#y3_x1</span></span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-18"><a href="#cb22-18" aria-hidden="true" tabindex="-1"></a><span class="co"># y's for component 2</span></span>
<span id="cb22-19"><a href="#cb22-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-20"><a href="#cb22-20" aria-hidden="true" tabindex="-1"></a>y1_x2 <span class="ot">&lt;-</span> f_y1_c2 <span class="sc">/</span> x2_freqs</span>
<span id="cb22-21"><a href="#cb22-21" aria-hidden="true" tabindex="-1"></a><span class="co">#y1_x2</span></span>
<span id="cb22-22"><a href="#cb22-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-23"><a href="#cb22-23" aria-hidden="true" tabindex="-1"></a>y2_x2 <span class="ot">&lt;-</span> f_y2_c2 <span class="sc">/</span> x2_freqs</span>
<span id="cb22-24"><a href="#cb22-24" aria-hidden="true" tabindex="-1"></a><span class="co">#y2_x2</span></span>
<span id="cb22-25"><a href="#cb22-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-26"><a href="#cb22-26" aria-hidden="true" tabindex="-1"></a>y3_x2 <span class="ot">&lt;-</span> f_y3_c2 <span class="sc">/</span> x2_freqs</span>
<span id="cb22-27"><a href="#cb22-27" aria-hidden="true" tabindex="-1"></a><span class="co">#y3_x2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Arrange new model parameters into a table.</p>
<div class="cell" data-hash="em-demo--12-Apr-2023-_cache/html/unnamed-chunk-22_6df73e13872aab27a411dc8468b390b7">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>new <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">estimate=</span><span class="st">"new"</span>,</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>                  <span class="at">probs=</span>params1<span class="sc">$</span>probs[<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>],</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>                  <span class="at">iteration=</span><span class="dv">2</span>) <span class="sc">%&gt;%</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">mutate</span>(<span class="at">X1=</span><span class="fu">c</span>(pnew_x1,</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>                  y1_x1,</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>                  y2_x1,</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>                  y3_x1),</span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>                  <span class="at">X2=</span><span class="fu">c</span>(pnew_x2,</span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>                  y1_x2,</span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>                  y2_x2,</span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>                  y3_x2))</span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a>              </span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a><span class="co">#flextable(new)</span></span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a>params2 <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(params2, new)</span>
<span id="cb23-16"><a href="#cb23-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-17"><a href="#cb23-17" aria-hidden="true" tabindex="-1"></a><span class="fu">flextable</span>(params2) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div class="tabwid"><style>.cl-89d4162c{}.cl-89cd1c5a{font-family:'Arial';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-89cfd012{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-89cfd01c{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-89cfdfe4{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-89cfdfee{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-89cfdfef{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-89cfdff8{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-89cfdff9{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-89cfdffa{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing="true" class="cl-89d4162c"><thead><tr style="overflow-wrap:break-word;"><th class="cl-89cfdfe4"><p class="cl-89cfd012"><span class="cl-89cd1c5a">estimate</span></p></th><th class="cl-89cfdfe4"><p class="cl-89cfd012"><span class="cl-89cd1c5a">probs</span></p></th><th class="cl-89cfdfee"><p class="cl-89cfd01c"><span class="cl-89cd1c5a">iteration</span></p></th><th class="cl-89cfdfee"><p class="cl-89cfd01c"><span class="cl-89cd1c5a">X1</span></p></th><th class="cl-89cfdfee"><p class="cl-89cfd01c"><span class="cl-89cd1c5a">X2</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-89cfdfef"><p class="cl-89cfd012"><span class="cl-89cd1c5a">current</span></p></td><td class="cl-89cfdfef"><p class="cl-89cfd012"><span class="cl-89cd1c5a">P(X)</span></p></td><td class="cl-89cfdff8"><p class="cl-89cfd01c"><span class="cl-89cd1c5a">2</span></p></td><td class="cl-89cfdff8"><p class="cl-89cfd01c"><span class="cl-89cd1c5a">0.558</span></p></td><td class="cl-89cfdff8"><p class="cl-89cfd01c"><span class="cl-89cd1c5a">0.442</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-89cfdfef"><p class="cl-89cfd012"><span class="cl-89cd1c5a">current</span></p></td><td class="cl-89cfdfef"><p class="cl-89cfd012"><span class="cl-89cd1c5a">P(y1=1|X)</span></p></td><td class="cl-89cfdff8"><p class="cl-89cfd01c"><span class="cl-89cd1c5a">2</span></p></td><td class="cl-89cfdff8"><p class="cl-89cfd01c"><span class="cl-89cd1c5a">0.831</span></p></td><td class="cl-89cfdff8"><p class="cl-89cfd01c"><span class="cl-89cd1c5a">0.495</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-89cfdfef"><p class="cl-89cfd012"><span class="cl-89cd1c5a">current</span></p></td><td class="cl-89cfdfef"><p class="cl-89cfd012"><span class="cl-89cd1c5a">P(y2=1|X)</span></p></td><td class="cl-89cfdff8"><p class="cl-89cfd01c"><span class="cl-89cd1c5a">2</span></p></td><td class="cl-89cfdff8"><p class="cl-89cfd01c"><span class="cl-89cd1c5a">0.633</span></p></td><td class="cl-89cfdff8"><p class="cl-89cfd01c"><span class="cl-89cd1c5a">0.279</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-89cfdfef"><p class="cl-89cfd012"><span class="cl-89cd1c5a">current</span></p></td><td class="cl-89cfdfef"><p class="cl-89cfd012"><span class="cl-89cd1c5a">P(y3=1|X)</span></p></td><td class="cl-89cfdff8"><p class="cl-89cfd01c"><span class="cl-89cd1c5a">2</span></p></td><td class="cl-89cfdff8"><p class="cl-89cfd01c"><span class="cl-89cd1c5a">0.808</span></p></td><td class="cl-89cfdff8"><p class="cl-89cfd01c"><span class="cl-89cd1c5a">0.473</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-89cfdfef"><p class="cl-89cfd012"><span class="cl-89cd1c5a">new</span></p></td><td class="cl-89cfdfef"><p class="cl-89cfd012"><span class="cl-89cd1c5a">P(X)</span></p></td><td class="cl-89cfdff8"><p class="cl-89cfd01c"><span class="cl-89cd1c5a">2</span></p></td><td class="cl-89cfdff8"><p class="cl-89cfd01c"><span class="cl-89cd1c5a">0.561</span></p></td><td class="cl-89cfdff8"><p class="cl-89cfd01c"><span class="cl-89cd1c5a">0.439</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-89cfdfef"><p class="cl-89cfd012"><span class="cl-89cd1c5a">new</span></p></td><td class="cl-89cfdfef"><p class="cl-89cfd012"><span class="cl-89cd1c5a">P(y1=1|X)</span></p></td><td class="cl-89cfdff8"><p class="cl-89cfd01c"><span class="cl-89cd1c5a">2</span></p></td><td class="cl-89cfdff8"><p class="cl-89cfd01c"><span class="cl-89cd1c5a">0.910</span></p></td><td class="cl-89cfdff8"><p class="cl-89cfd01c"><span class="cl-89cd1c5a">0.392</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-89cfdfef"><p class="cl-89cfd012"><span class="cl-89cd1c5a">new</span></p></td><td class="cl-89cfdfef"><p class="cl-89cfd012"><span class="cl-89cd1c5a">P(y2=1|X)</span></p></td><td class="cl-89cfdff8"><p class="cl-89cfd01c"><span class="cl-89cd1c5a">2</span></p></td><td class="cl-89cfdff8"><p class="cl-89cfd01c"><span class="cl-89cd1c5a">0.713</span></p></td><td class="cl-89cfdff8"><p class="cl-89cfd01c"><span class="cl-89cd1c5a">0.175</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-89cfdff9"><p class="cl-89cfd012"><span class="cl-89cd1c5a">new</span></p></td><td class="cl-89cfdff9"><p class="cl-89cfd012"><span class="cl-89cd1c5a">P(y3=1|X)</span></p></td><td class="cl-89cfdffa"><p class="cl-89cfd01c"><span class="cl-89cd1c5a">2</span></p></td><td class="cl-89cfdffa"><p class="cl-89cfd01c"><span class="cl-89cd1c5a">0.889</span></p></td><td class="cl-89cfdffa"><p class="cl-89cfd01c"><span class="cl-89cd1c5a">0.367</span></p></td></tr></tbody></table></div>
</div>
</div>
<p>As with iteration 1, the probability of component 1 has increased, while the probability for component 2 has decreased. Item agreement is more associated with component 1 than component 2.</p>
<p>Now let’s look at the log likelihood.</p>
<div class="cell" data-hash="em-demo--12-Apr-2023-_cache/html/unnamed-chunk-23_fc89758c6e67078dd17c4e1061ccb925">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>freqs2 <span class="ot">&lt;-</span> freqs2 <span class="sc">%&gt;%</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ll=</span>frq<span class="sc">*</span><span class="fu">log</span>(joint_y))</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a><span class="fu">flextable</span>(freqs2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div class="tabwid"><style>.cl-b6858bbc{}.cl-b67bdeb4{font-family:'Arial';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-b67f90c2{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-b67f90cc{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-b67fa3fa{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-b67fa404{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-b67fa405{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-b67fa40e{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-b67fa40f{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-b67fa418{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing="true" class="cl-b6858bbc"><thead><tr style="overflow-wrap:break-word;"><th class="cl-b67fa3fa"><p class="cl-b67f90c2"><span class="cl-b67bdeb4">val</span></p></th><th class="cl-b67fa404"><p class="cl-b67f90cc"><span class="cl-b67bdeb4">frq</span></p></th><th class="cl-b67fa404"><p class="cl-b67f90cc"><span class="cl-b67bdeb4">perc</span></p></th><th class="cl-b67fa404"><p class="cl-b67f90cc"><span class="cl-b67bdeb4">iteration</span></p></th><th class="cl-b67fa404"><p class="cl-b67f90cc"><span class="cl-b67bdeb4">joint_x1</span></p></th><th class="cl-b67fa404"><p class="cl-b67f90cc"><span class="cl-b67bdeb4">joint_x2</span></p></th><th class="cl-b67fa404"><p class="cl-b67f90cc"><span class="cl-b67bdeb4">joint_y</span></p></th><th class="cl-b67fa404"><p class="cl-b67f90cc"><span class="cl-b67bdeb4">x1_y</span></p></th><th class="cl-b67fa404"><p class="cl-b67f90cc"><span class="cl-b67bdeb4">x2_y</span></p></th><th class="cl-b67fa404"><p class="cl-b67f90cc"><span class="cl-b67bdeb4">frq_x1</span></p></th><th class="cl-b67fa404"><p class="cl-b67f90cc"><span class="cl-b67bdeb4">frq_x2</span></p></th><th class="cl-b67fa404"><p class="cl-b67f90cc"><span class="cl-b67bdeb4">ll</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-b67fa405"><p class="cl-b67f90c2"><span class="cl-b67bdeb4">1-1-1</span></p></td><td class="cl-b67fa40e"><p class="cl-b67f90cc"><span class="cl-b67bdeb4">696</span></p></td><td class="cl-b67fa40e"><p class="cl-b67f90cc"><span class="cl-b67bdeb4">0.406</span></p></td><td class="cl-b67fa40e"><p class="cl-b67f90cc"><span class="cl-b67bdeb4">2</span></p></td><td class="cl-b67fa40e"><p class="cl-b67f90cc"><span class="cl-b67bdeb4">0.4250</span></p></td><td class="cl-b67fa40e"><p class="cl-b67f90cc"><span class="cl-b67bdeb4">0.0653</span></p></td><td class="cl-b67fa40e"><p class="cl-b67f90cc"><span class="cl-b67bdeb4">0.2661</span></p></td><td class="cl-b67fa40e"><p class="cl-b67f90cc"><span class="cl-b67bdeb4">0.8916</span></p></td><td class="cl-b67fa40e"><p class="cl-b67f90cc"><span class="cl-b67bdeb4">0.108</span></p></td><td class="cl-b67fa40e"><p class="cl-b67f90cc"><span class="cl-b67bdeb4">620.56</span></p></td><td class="cl-b67fa40e"><p class="cl-b67f90cc"><span class="cl-b67bdeb4">75.4</span></p></td><td class="cl-b67fa40e"><p class="cl-b67f90cc"><span class="cl-b67bdeb4">-921.4</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-b67fa405"><p class="cl-b67f90c2"><span class="cl-b67bdeb4">1-1-2</span></p></td><td class="cl-b67fa40e"><p class="cl-b67f90cc"><span class="cl-b67bdeb4">68</span></p></td><td class="cl-b67fa40e"><p class="cl-b67f90cc"><span class="cl-b67bdeb4">0.040</span></p></td><td class="cl-b67fa40e"><p class="cl-b67f90cc"><span class="cl-b67bdeb4">2</span></p></td><td class="cl-b67fa40e"><p class="cl-b67f90cc"><span class="cl-b67bdeb4">0.1329</span></p></td><td class="cl-b67fa40e"><p class="cl-b67f90cc"><span class="cl-b67bdeb4">0.1290</span></p></td><td class="cl-b67fa40e"><p class="cl-b67f90cc"><span class="cl-b67bdeb4">0.1312</span></p></td><td class="cl-b67fa40e"><p class="cl-b67f90cc"><span class="cl-b67bdeb4">0.5656</span></p></td><td class="cl-b67fa40e"><p class="cl-b67f90cc"><span class="cl-b67bdeb4">0.434</span></p></td><td class="cl-b67fa40e"><p class="cl-b67f90cc"><span class="cl-b67bdeb4">38.46</span></p></td><td class="cl-b67fa40e"><p class="cl-b67f90cc"><span class="cl-b67bdeb4">29.5</span></p></td><td class="cl-b67fa40e"><p class="cl-b67f90cc"><span class="cl-b67bdeb4">-138.1</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-b67fa405"><p class="cl-b67f90c2"><span class="cl-b67bdeb4">1-2-1</span></p></td><td class="cl-b67fa40e"><p class="cl-b67f90cc"><span class="cl-b67bdeb4">275</span></p></td><td class="cl-b67fa40e"><p class="cl-b67f90cc"><span class="cl-b67bdeb4">0.160</span></p></td><td class="cl-b67fa40e"><p class="cl-b67f90cc"><span class="cl-b67bdeb4">2</span></p></td><td class="cl-b67fa40e"><p class="cl-b67f90cc"><span class="cl-b67bdeb4">0.2460</span></p></td><td class="cl-b67fa40e"><p class="cl-b67f90cc"><span class="cl-b67bdeb4">0.1685</span></p></td><td class="cl-b67fa40e"><p class="cl-b67f90cc"><span class="cl-b67bdeb4">0.2118</span></p></td><td class="cl-b67fa40e"><p class="cl-b67f90cc"><span class="cl-b67bdeb4">0.6485</span></p></td><td class="cl-b67fa40e"><p class="cl-b67f90cc"><span class="cl-b67bdeb4">0.351</span></p></td><td class="cl-b67fa40e"><p class="cl-b67f90cc"><span class="cl-b67bdeb4">178.34</span></p></td><td class="cl-b67fa40e"><p class="cl-b67f90cc"><span class="cl-b67bdeb4">96.7</span></p></td><td class="cl-b67fa40e"><p class="cl-b67f90cc"><span class="cl-b67bdeb4">-426.8</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-b67fa405"><p class="cl-b67f90c2"><span class="cl-b67bdeb4">1-2-2</span></p></td><td class="cl-b67fa40e"><p class="cl-b67f90cc"><span class="cl-b67bdeb4">130</span></p></td><td class="cl-b67fa40e"><p class="cl-b67f90cc"><span class="cl-b67bdeb4">0.076</span></p></td><td class="cl-b67fa40e"><p class="cl-b67f90cc"><span class="cl-b67bdeb4">2</span></p></td><td class="cl-b67fa40e"><p class="cl-b67f90cc"><span class="cl-b67bdeb4">0.0586</span></p></td><td class="cl-b67fa40e"><p class="cl-b67f90cc"><span class="cl-b67bdeb4">0.1880</span></p></td><td class="cl-b67fa40e"><p class="cl-b67f90cc"><span class="cl-b67bdeb4">0.1158</span></p></td><td class="cl-b67fa40e"><p class="cl-b67f90cc"><span class="cl-b67bdeb4">0.2828</span></p></td><td class="cl-b67fa40e"><p class="cl-b67f90cc"><span class="cl-b67bdeb4">0.717</span></p></td><td class="cl-b67fa40e"><p class="cl-b67f90cc"><span class="cl-b67bdeb4">36.76</span></p></td><td class="cl-b67fa40e"><p class="cl-b67f90cc"><span class="cl-b67bdeb4">93.2</span></p></td><td class="cl-b67fa40e"><p class="cl-b67f90cc"><span class="cl-b67bdeb4">-280.3</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-b67fa405"><p class="cl-b67f90c2"><span class="cl-b67bdeb4">2-1-1</span></p></td><td class="cl-b67fa40e"><p class="cl-b67f90cc"><span class="cl-b67bdeb4">34</span></p></td><td class="cl-b67fa40e"><p class="cl-b67f90cc"><span class="cl-b67bdeb4">0.020</span></p></td><td class="cl-b67fa40e"><p class="cl-b67f90cc"><span class="cl-b67bdeb4">2</span></p></td><td class="cl-b67fa40e"><p class="cl-b67f90cc"><span class="cl-b67bdeb4">0.0865</span></p></td><td class="cl-b67fa40e"><p class="cl-b67f90cc"><span class="cl-b67bdeb4">0.0667</span></p></td><td class="cl-b67fa40e"><p class="cl-b67f90cc"><span class="cl-b67bdeb4">0.0777</span></p></td><td class="cl-b67fa40e"><p class="cl-b67f90cc"><span class="cl-b67bdeb4">0.6209</span></p></td><td class="cl-b67fa40e"><p class="cl-b67f90cc"><span class="cl-b67bdeb4">0.379</span></p></td><td class="cl-b67fa40e"><p class="cl-b67f90cc"><span class="cl-b67bdeb4">21.11</span></p></td><td class="cl-b67fa40e"><p class="cl-b67f90cc"><span class="cl-b67bdeb4">12.9</span></p></td><td class="cl-b67fa40e"><p class="cl-b67f90cc"><span class="cl-b67bdeb4">-86.9</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-b67fa405"><p class="cl-b67f90c2"><span class="cl-b67bdeb4">2-1-2</span></p></td><td class="cl-b67fa40e"><p class="cl-b67f90cc"><span class="cl-b67bdeb4">19</span></p></td><td class="cl-b67fa40e"><p class="cl-b67f90cc"><span class="cl-b67bdeb4">0.011</span></p></td><td class="cl-b67fa40e"><p class="cl-b67f90cc"><span class="cl-b67bdeb4">2</span></p></td><td class="cl-b67fa40e"><p class="cl-b67f90cc"><span class="cl-b67bdeb4">0.0206</span></p></td><td class="cl-b67fa40e"><p class="cl-b67f90cc"><span class="cl-b67bdeb4">0.0744</span></p></td><td class="cl-b67fa40e"><p class="cl-b67f90cc"><span class="cl-b67bdeb4">0.0444</span></p></td><td class="cl-b67fa40e"><p class="cl-b67f90cc"><span class="cl-b67bdeb4">0.2593</span></p></td><td class="cl-b67fa40e"><p class="cl-b67f90cc"><span class="cl-b67bdeb4">0.741</span></p></td><td class="cl-b67fa40e"><p class="cl-b67f90cc"><span class="cl-b67bdeb4">4.93</span></p></td><td class="cl-b67fa40e"><p class="cl-b67f90cc"><span class="cl-b67bdeb4">14.1</span></p></td><td class="cl-b67fa40e"><p class="cl-b67f90cc"><span class="cl-b67bdeb4">-59.2</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-b67fa405"><p class="cl-b67f90c2"><span class="cl-b67bdeb4">2-2-1</span></p></td><td class="cl-b67fa40e"><p class="cl-b67f90cc"><span class="cl-b67bdeb4">125</span></p></td><td class="cl-b67fa40e"><p class="cl-b67f90cc"><span class="cl-b67bdeb4">0.073</span></p></td><td class="cl-b67fa40e"><p class="cl-b67f90cc"><span class="cl-b67bdeb4">2</span></p></td><td class="cl-b67fa40e"><p class="cl-b67f90cc"><span class="cl-b67bdeb4">0.0500</span></p></td><td class="cl-b67fa40e"><p class="cl-b67f90cc"><span class="cl-b67bdeb4">0.1722</span></p></td><td class="cl-b67fa40e"><p class="cl-b67f90cc"><span class="cl-b67bdeb4">0.1040</span></p></td><td class="cl-b67fa40e"><p class="cl-b67f90cc"><span class="cl-b67bdeb4">0.2687</span></p></td><td class="cl-b67fa40e"><p class="cl-b67f90cc"><span class="cl-b67bdeb4">0.731</span></p></td><td class="cl-b67fa40e"><p class="cl-b67f90cc"><span class="cl-b67bdeb4">33.59</span></p></td><td class="cl-b67fa40e"><p class="cl-b67f90cc"><span class="cl-b67bdeb4">91.4</span></p></td><td class="cl-b67fa40e"><p class="cl-b67f90cc"><span class="cl-b67bdeb4">-282.9</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-b67fa40f"><p class="cl-b67f90c2"><span class="cl-b67bdeb4">2-2-2</span></p></td><td class="cl-b67fa418"><p class="cl-b67f90cc"><span class="cl-b67bdeb4">366</span></p></td><td class="cl-b67fa418"><p class="cl-b67f90cc"><span class="cl-b67bdeb4">0.214</span></p></td><td class="cl-b67fa418"><p class="cl-b67f90cc"><span class="cl-b67bdeb4">2</span></p></td><td class="cl-b67fa418"><p class="cl-b67f90cc"><span class="cl-b67bdeb4">0.0119</span></p></td><td class="cl-b67fa418"><p class="cl-b67f90cc"><span class="cl-b67bdeb4">0.1920</span></p></td><td class="cl-b67fa418"><p class="cl-b67f90cc"><span class="cl-b67bdeb4">0.0915</span></p></td><td class="cl-b67fa418"><p class="cl-b67f90cc"><span class="cl-b67bdeb4">0.0728</span></p></td><td class="cl-b67fa418"><p class="cl-b67f90cc"><span class="cl-b67bdeb4">0.927</span></p></td><td class="cl-b67fa418"><p class="cl-b67f90cc"><span class="cl-b67bdeb4">26.64</span></p></td><td class="cl-b67fa418"><p class="cl-b67f90cc"><span class="cl-b67bdeb4">339.4</span></p></td><td class="cl-b67fa418"><p class="cl-b67f90cc"><span class="cl-b67bdeb4">-875.3</span></p></td></tr></tbody></table></div>
</div>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>ll_2 <span class="ot">&lt;-</span> <span class="fu">sum</span>(freqs2<span class="sc">$</span>ll)</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>ll_1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -3468</code></pre>
</div>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>ll_2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -3071</code></pre>
</div>
</div>
<p>The overall log likelihood has increased, which means we are closer to our convergance (maximization of the likelihood of the data).</p>
<p>These iterations continue, with each iteration guaranteed to increase the log likelihood of the model. When the iterations result in negligible increases to the log likelihood, the algorithm is said to have converged and we have arrived at a solution.</p>
<p>It’s possible that the algorithm identified a local maximum, rather than a global maximum. Initialize a few different random starts to see if you get to the same solution. If you do not, take the solution with the highest log likelihood.</p>

</section>


</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>